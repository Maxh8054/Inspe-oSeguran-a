<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Avan√ßado de Inspe√ß√£o de √Årea - Vers√£o em Rede</title>
    <style>
        /* Estilos existentes (mantidos) */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #ff6600;
            --black: #000000;
            --white: #ffffff;
            --gray-light: #f5f5f5;
            --gray-medium: #666666;
            --gray-dark: #333333;
            --danger: #dc3545;
            --warning: #ffc107;
            --success: #28a745;
            --info: #17a2b8;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: var(--white);
            min-height: 100vh;
            line-height: 1.6;
            padding-top: 60px;
        }

        .menu-toggle {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: none;
        }

        .nav-menu {
            display: flex;
            gap: 10px;
            transition: all 0.3s ease;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
            
            .nav-menu {
                position: absolute;
                top: 70px;
                right: 20px;
                background: var(--black);
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                flex-direction: column;
                z-index: 1000;
                opacity: 0;
                pointer-events: none;
                transform: translateY(-10px);
            }
            
            .nav-menu.active {
                opacity: 1;
                pointer-events: all;
                transform: translateY(0);
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--black);
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        h1 {
            font-size: 28px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--white);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            color: var(--black);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray-dark);
        }

        input[type="text"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: var(--white);
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 102, 0, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .risk-levels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .risk-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            background: var(--white);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            text-align: center;
        }

        .risk-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .risk-btn.active {
            color: var(--white);
            border-color: transparent;
        }

        .risk-btn.low.active {
            background: var(--success);
        }

        .risk-btn.medium.active {
            background: var(--warning);
        }

        .risk-btn.high.active {
            background: var(--danger);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: var(--white);
        }

        .btn-primary:hover {
            background: #e55a00;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 102, 0, 0.3);
        }

        .btn-secondary {
            background: var(--gray-dark);
            color: var(--white);
        }

        .btn-secondary:hover {
            background: #555;
        }

        .btn-info {
            background: var(--info);
            color: var(--white);
        }

        .btn-info:hover {
            background: #138496;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .inspection-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .inspection-item {
            background: var(--gray-light);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .inspection-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .inspection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .inspection-date {
            font-size: 12px;
            color: var(--gray-medium);
        }

        .risk-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: var(--white);
        }

        .risk-badge.low {
            background: var(--success);
        }

        .risk-badge.medium {
            background: var(--warning);
        }

        .risk-badge.high {
            background: var(--danger);
        }

        .inspection-description {
            color: var(--gray-dark);
            margin-bottom: 8px;
        }

        .inspection-observations {
            font-size: 13px;
            color: var(--gray-medium);
        }

        .delete-btn,
        .export-btn,
        .export-checkbox {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--danger);
            color: var(--white);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .export-checkbox {
            right: 80px;
            background: var(--primary-color);
            opacity: 1;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border: 2px solid var(--white);
        }

        .export-checkbox:checked {
            background: var(--success);
            content: '‚úì';
        }

        .export-checkbox:checked::after {
            content: '‚úì';
            color: white;
            font-size: 14px;
        }

        .inspection-item:hover .export-checkbox {
            opacity: 1;
        }

        .delete-btn {
            background: var(--danger);
            color: var(--white);
        }

        .export-btn {
            background: var(--info);
            color: var(--white);
        }

        .inspection-item:hover .delete-btn,
        .inspection-item:hover .export-btn {
            opacity: 1;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .export-btn:hover {
            background: #138496;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--gray-medium);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            border-radius: 12px;
            padding: 30px;
            max-width: 90%;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            color: var(--black);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: var(--gray-medium);
        }

        .close-modal:hover {
            color: var(--black);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--white);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 12px;
            color: var(--gray-medium);
            margin-top: 5px;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: var(--white);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 2000;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background: var(--danger);
        }

        .location-input {
            display: flex;
            gap: 10px;
        }

        .location-input input {
            flex: 1;
        }

        .photo-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .photo-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            background: var(--gray-light);
            aspect-ratio: 1;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .photo-item:hover {
            transform: scale(1.05);
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-risk-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            color: var(--white);
        }

        .photo-actions {
            position: absolute;
            bottom: 5px;
            left: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .photo-item:hover .photo-actions {
            opacity: 1;
        }

        .photo-action-btn {
            background: rgba(0,0,0,0.7);
            color: var(--white);
            border: none;
            border-radius: 4px;
            padding: 5px;
            cursor: pointer;
            font-size: 12px;
            flex: 1;
        }

        .photo-action-btn:hover {
            background: rgba(0,0,0,0.9);
        }

        .add-photo-btn {
            border: 2px dashed #e0e0e0;
            background: var(--gray-light);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            aspect-ratio: 1;
        }

        .add-photo-btn:hover {
            border-color: var(--primary-color);
            background: rgba(255, 102, 0, 0.05);
        }

        .add-photo-btn span {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .add-photo-btn small {
            color: var(--gray-medium);
        }

        .image-editor {
            position: relative;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
        }

        .editor-canvas {
            display: block;
            max-width: 100%;
            cursor: crosshair;
        }

        .editor-toolbar {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 8px;
        }

        .editor-tool {
            background: var(--primary-color);
            color: var(--white);
            border: none;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .editor-tool:hover {
            background: #e55a00;
        }

        .editor-tool.active {
            background: var(--success);
        }

        .color-picker {
            width: 40px;
            height: 32px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .deadline-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .deadline-warning.overdue {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 102, 0, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(255, 102, 0, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 102, 0, 0);
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Novos estilos para status e progresso */
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: var(--white);
            margin-left: 10px;
        }

        .status-badge.pending {
            background: var(--gray-medium);
        }

        .status-badge.in-progress {
            background: var(--info);
        }

        .status-badge.completed {
            background: var(--success);
        }

        .progress-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-top: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 12px;
            color: var(--gray-medium);
            margin-top: 5px;
            display: flex;
            justify-content: space-between;
        }

        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .filter-tab {
            padding: 10px 15px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray-medium);
            transition: all 0.3s ease;
        }

        .filter-tab:hover {
            color: var(--gray-dark);
        }

        .filter-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .resolution-section {
            margin-top: 20px;
            padding: 15px;
            background: var(--gray-light);
            border-radius: 8px;
        }

        .resolution-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .resolution-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: var(--white);
        }

        .resolution-status.pending {
            background: var(--gray-medium);
        }

        .resolution-status.resolved {
            background: var(--success);
        }

        .resolution-form {
            display: none;
        }

        .resolution-form.active {
            display: block;
        }

        .resolution-photos {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .resolution-photo {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 1;
        }

        .resolution-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-source-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .source-option {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .source-option:hover {
            border-color: var(--primary-color);
            background: rgba(255, 102, 0, 0.05);
        }

        .source-option span {
            display: block;
            font-size: 24px;
            margin-bottom: 5px;
        }

        .source-option small {
            color: var(--gray-medium);
        }

        /* Estilos para o checklist de seguran√ßa */
        .safety-checklist {
            margin-top: 20px;
            border-top: 1px solid #e0e0e0;
            padding-top: 20px;
        }

        .checklist-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .checklist-tab {
            padding: 8px 12px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray-medium);
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .checklist-tab:hover {
            color: var(--gray-dark);
        }

        .checklist-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .checklist-content {
            display: none;
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .checklist-content.active {
            display: block;
        }

        .checklist-question {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background: var(--gray-light);
        }

        .checklist-question:hover {
            background: #e9ecef;
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--gray-dark);
        }

        .answer-options {
            display: flex;
            gap: 10px;
        }

        .answer-option {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .answer-option input[type="radio"] {
            width: auto;
            margin: 0;
        }

        .answer-option label {
            margin: 0;
            font-weight: normal;
            cursor: pointer;
        }

        .checklist-summary {
            margin-top: 15px;
            padding: 15px;
            background: #e9f7ef;
            border-radius: 8px;
            border-left: 4px solid var(--success);
        }

        .summary-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--gray-dark);
        }

        .summary-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .summary-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .summary-stat-value {
            font-weight: 600;
        }

        .summary-stat-label {
            font-size: 14px;
            color: var(--gray-medium);
        }

        .summary-score {
            margin-top: 10px;
            font-size: 16px;
            font-weight: 600;
        }

        .score-good {
            color: var(--success);
        }

        .score-medium {
            color: var(--warning);
        }

        .score-bad {
            color: var(--danger);
        }

        /* Estilos para o hist√≥rico de inspe√ß√µes */
        .history-container {
            margin-top: 20px;
        }

        .history-timeline {
            position: relative;
            padding: 20px 0;
        }

        .history-timeline::before {
            content: '';
            position: absolute;
            top: 0;
            left: 20px;
            height: 100%;
            width: 2px;
            background: var(--gray-medium);
        }

        .history-item {
            position: relative;
            padding-left: 50px;
            margin-bottom: 30px;
        }

        .history-item::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 12px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--primary-color);
            border: 3px solid var(--white);
            box-shadow: 0 0 0 3px rgba(255, 102, 0, 0.2);
        }

        .history-date {
            font-size: 14px;
            color: var(--gray-medium);
            margin-bottom: 5px;
        }

        .history-content {
            background: var(--white);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .history-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-actions {
            display: flex;
            gap: 10px;
        }

        .history-action-btn {
            background: none;
            border: none;
            color: var(--gray-medium);
            cursor: pointer;
            font-size: 16px;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .history-action-btn:hover {
            background: var(--gray-light);
            color: var(--primary-color);
        }

        .history-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .history-detail {
            font-size: 14px;
        }

        .history-detail-label {
            font-weight: 500;
            color: var(--gray-medium);
        }

        .history-detail-value {
            color: var(--gray-dark);
        }

        .history-photos {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .history-photo {
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 1;
        }

        .history-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .history-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            color: var(--white);
            margin-left: 10px;
        }

        .history-status.pending {
            background: var(--gray-medium);
        }

        .history-status.in-progress {
            background: var(--info);
        }

        .history-status.completed {
            background: var(--success);
        }

        .history-progress {
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            margin-top: 8px;
            overflow: hidden;
        }

        .history-progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
        }

        .empty-history {
            text-align: center;
            padding: 40px;
            color: var(--gray-medium);
        }

        .empty-history-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .success-animation {
            animation: successPulse 0.5s ease-in-out;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Estilos para a importa√ß√£o/exporta√ß√£o JSON */
        .json-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .backup-status {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: var(--gray-medium);
            margin-top: 5px;
        }

        .backup-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-wrapper .btn {
            margin: 0;
        }

        /* Estilos para indicador de sincroniza√ß√£o */
        .sync-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: var(--gray-medium);
            margin-top: 5px;
        }

        .sync-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
        }

        .sync-status.syncing {
            background: var(--warning);
            animation: pulse 1s infinite;
        }

        .sync-status.error {
            background: var(--danger);
        }

        /* Estilos para configura√ß√£o de rede */
        .network-config {
            background: var(--gray-light);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            display: none;
        }

        .network-config.active {
            display: block;
        }

        .config-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--gray-dark);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .config-close {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: var(--gray-medium);
        }

        .config-close:hover {
            color: var(--black);
        }

        .config-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 768px) {
            .config-form {
                grid-template-columns: 1fr;
            }
        }

        .config-field {
            display: flex;
            flex-direction: column;
        }

        .config-field label {
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: 500;
        }

        .config-field input {
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }

        .config-buttons {
            grid-column: span 2;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        @media (max-width: 768px) {
            .config-buttons {
                grid-column: span 1;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.11.0/dist/pptxgen.bundle.js"></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>
                <div class="logo">üìã</div>
                Sistema Avan√ßado de Inspe√ß√£o - Vers√£o em Rede
            </h1>
            <button class="menu-toggle" onclick="toggleMenu()">
                ‚ò∞ Menu
            </button>
            <div class="nav-menu" id="navMenu">
                <div class="file-input-wrapper">
                    <button class="btn btn-info" onclick="document.getElementById('importJson').click()">
                        üìÇ Importar JSON
                    </button>
                    <input type="file" id="importJson" accept=".json" onchange="importJSON(event)">
                </div>
                <button class="btn btn-info" onclick="exportJSON()">
                    üíæ Exportar JSON
                </button>
                <button class="btn btn-primary" onclick="exportSelectedPPT()">
                    üìΩÔ∏è Exportar PPT
                </button>
                <button class="btn btn-secondary" onclick="toggleNetworkConfig()">
                    ‚öôÔ∏è Configura√ß√£o de Rede
                </button>
                <button class="btn btn-info" onclick="syncData()">
                    üîÑ Sincronizar Agora
                </button>
            </div>
        </div>
    </header>

    <!-- Configura√ß√£o de Rede -->
    <div class="network-config" id="networkConfig">
        <div class="config-title">
            Configura√ß√£o de Rede
            <button class="config-close" onclick="toggleNetworkConfig()">&times;</button>
        </div>
        <div class="config-form">
            <div class="config-field">
                <label for="serverUrl">URL do Servidor</label>
                <input type="text" id="serverUrl" placeholder="http://servidor.local/api" value="">
            </div>
            <div class="config-field">
                <label for="syncInterval">Intervalo de Sincroniza√ß√£o (segundos)</label>
                <input type="number" id="syncInterval" min="10" value="30">
            </div>
            <div class="config-field">
                <label for="apiKey">Chave de API (opcional)</label>
                <input type="password" id="apiKey" placeholder="Chave de autentica√ß√£o">
            </div>
            <div class="config-field">
                <label for="dataPath">Caminho do Arquivo de Dados</label>
                <input type="text" id="dataPath" placeholder="/data/inspections.json" value="/data/inspections.json">
            </div>
            <div class="config-buttons">
                <button class="btn btn-secondary" onclick="testConnection()">Testar Conex√£o</button>
                <button class="btn btn-primary" onclick="saveNetworkConfig()">Salvar Configura√ß√£o</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">Total de Inspe√ß√µes</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="highRiskCount">0</div>
                <div class="stat-label">Risco Alto</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="overdueCount">0</div>
                <div class="stat-label">Prazos Vencidos</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="completedCount">0</div>
                <div class="stat-label">Inspe√ß√µes Conclu√≠das</div>
            </div>
        </div>
        <div class="sync-indicator">
            <div class="sync-status" id="syncStatus"></div>
            <span id="syncMessage">Sincroniza√ß√£o: Desativada</span>
        </div>

        <div class="main-content">
            <div class="card">
                <h2 class="card-title" id="formTitle">üìù Nova Inspe√ß√£o</h2>
                <form id="inspectionForm">
                    <div class="form-group">
                        <label for="areaName">Nome da √Årea</label>
                        <input type="text" id="areaName" required placeholder="Ex: Galp√£o A, Setor de Produ√ß√£o">
                    </div>

                    <div class="form-group">
                        <label for="inspectionDate">Data da Inspe√ß√£o</label>
                        <input type="date" id="inspectionDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="deadlineDate">Prazo para Conclus√£o</label>
                        <input type="date" id="deadlineDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Localiza√ß√£o</label>
                        <div class="location-input">
                            <input type="text" id="location" placeholder="Clique para obter localiza√ß√£o atual" readonly>
                            <button type="button" class="btn btn-info" onclick="getLocation()">
                                üìç Obter Localiza√ß√£o
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>N√≠vel de Risco Geral</label>
                        <div class="risk-levels">
                            <button type="button" class="risk-btn low" onclick="setRiskLevel('low')">
                                ‚úÖ Baixo
                            </button>
                            <button type="button" class="risk-btn medium" onclick="setRiskLevel('medium')">
                                ‚ö†Ô∏è M√©dio
                            </button>
                            <button type="button" class="risk-btn high" onclick="setRiskLevel('high')">
                                üö® Alto
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Foto da √Årea</label>
                        <div class="photo-gallery" id="areaPhotoGallery">
                            <div class="add-photo-btn" onclick="addAreaPhoto()">
                                <span>üì∑</span>
                                <small>Adicionar Foto da √Årea</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="observations">Observa√ß√µes</label>
                        <textarea id="observations" placeholder="Adicione observa√ß√µes importantes, n√£o conformidades, recomenda√ß√µes..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Fotos da Inspe√ß√£o</label>
                        <div class="photo-gallery" id="photoGallery">
                            <div class="add-photo-btn" onclick="showPhotoSourceOptions()">
                                <span>üì∑</span>
                                <small>Adicionar Foto</small>
                            </div>
                        </div>
                    </div>

                    <!-- Checklist de Seguran√ßa -->
                    <div class="safety-checklist">
                        <h3 class="card-title">üîç Checklist de Seguran√ßa</h3>
                        
                        <div class="checklist-tabs">
                            <button class="checklist-tab active" onclick="switchChecklistTab('epi', this)">EPIs</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('incendio', this)">Inc√™ndio</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('isolamento', this)">Isolamento</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('quimicos', this)">Qu√≠micos</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('maquinas', this)">M√°quinas</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('ferramentas', this)">Ferramentas</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('armazenamento', this)">Armazenamento</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('uniformes', this)">Uniformes</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('pisos', this)">Pisos</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('organizacao', this)">Organiza√ß√£o</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('escadas', this)">Escadas</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('iluminacao', this)">Ilumina√ß√£o</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('bebedouros', this)">Bebedouros</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('banheiros', this)">Banheiros</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('inflamaveis', this)">Inflam√°veis</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('eletricidade', this)">Eletricidade</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('escritorio', this)">Escrit√≥rio</button>
                            <button class="checklist-tab" onclick="switchChecklistTab('fichaEPI', this)">Ficha EPI</button>
                        </div>
                        
                        <!-- Conte√∫do das abas do checklist -->
                        <div id="epi" class="checklist-content active">
                            <div class="checklist-question">
                                <div class="question-text">Possui estoque de EPIs em quantidade suficiente para atender os empregados?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="epi1_sim" name="epi1" value="sim">
                                        <label for="epi1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="epi1_nao" name="epi1" value="nao">
                                        <label for="epi1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="epi1_na" name="epi1" value="na">
                                        <label for="epi1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os EPIs est√£o adequadamente higienizados?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="epi2_sim" name="epi2" value="sim">
                                        <label for="epi2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="epi2_nao" name="epi2" value="nao">
                                        <label for="epi2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="epi2_na" name="epi2" value="na">
                                        <label for="epi2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os funcion√°rios receberam orienta√ß√µes para cuidar corretamente dos EPIs?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="epi3_sim" name="epi3" value="sim">
                                        <label for="epi3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="epi3_nao" name="epi3" value="nao">
                                        <label for="epi3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="epi3_na" name="epi3" value="na">
                                        <label for="epi3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="incendio" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">A manuten√ß√£o dos equipamentos est√° em dia?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inc1_sim" name="inc1" value="sim">
                                        <label for="inc1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc1_nao" name="inc1" value="nao">
                                        <label for="inc1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc1_na" name="inc1" value="na">
                                        <label for="inc1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os lacres, selos do INMETRO e adesivos orientativos est√£o em perfeito estado de conserva√ß√£o?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inc2_sim" name="inc2" value="sim">
                                        <label for="inc2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc2_nao" name="inc2" value="nao">
                                        <label for="inc2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc2_na" name="inc2" value="na">
                                        <label for="inc2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os extintores est√£o desobstru√≠dos?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inc3_sim" name="inc3" value="sim">
                                        <label for="inc3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc3_nao" name="inc3" value="nao">
                                        <label for="inc3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc3_na" name="inc3" value="na">
                                        <label for="inc3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os equipamentos de combate a inc√™ndio est√£o bem sinalizados?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inc4_sim" name="inc4" value="sim">
                                        <label for="inc4_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc4_nao" name="inc4" value="nao">
                                        <label for="inc4_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc4_na" name="inc4" value="na">
                                        <label for="inc4_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os extintores est√£o dentro do prazo de validade?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inc5_sim" name="inc5" value="sim">
                                        <label for="inc5_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc5_nao" name="inc5" value="nao">
                                        <label for="inc5_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc5_na" name="inc5" value="na">
                                        <label for="inc5_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">A empresa que faz a recarga dos extintores tem registro no Corpo e Bombeiros?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inc6_sim" name="inc6" value="sim">
                                        <label for="inc6_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc6_nao" name="inc6" value="nao">
                                        <label for="inc6_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inc6_na" name="inc6" value="na">
                                        <label for="inc6_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="isolamento" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Possui equipamentos para isolamento e sinaliza√ß√£o de √°rea?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="iso1_sim" name="iso1" value="sim">
                                        <label for="iso1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso1_nao" name="iso1" value="nao">
                                        <label for="iso1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso1_na" name="iso1" value="na">
                                        <label for="iso1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os equipamentos atendem em quantidades e tipos √†s necessidades?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="iso2_sim" name="iso2" value="sim">
                                        <label for="iso2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso2_nao" name="iso2" value="nao">
                                        <label for="iso2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso2_na" name="iso2" value="na">
                                        <label for="iso2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os equipamentos est√£o em bom estado de conserva√ß√£o?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="iso3_sim" name="iso3" value="sim">
                                        <label for="iso3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso3_nao" name="iso3" value="nao">
                                        <label for="iso3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso3_na" name="iso3" value="na">
                                        <label for="iso3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Possui placa de manuten√ß√£o de equipamento?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="iso4_sim" name="iso4" value="sim">
                                        <label for="iso4_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso4_nao" name="iso4" value="nao">
                                        <label for="iso4_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="iso4_na" name="iso4" value="na">
                                        <label for="iso4_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="quimicos" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">O local possui espa√ßo adequado para estoque de produtos qu√≠micos?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="qui1_sim" name="qui1" value="sim">
                                        <label for="qui1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="qui1_nao" name="qui1" value="nao">
                                        <label for="qui1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="qui1_na" name="qui1" value="na">
                                        <label for="qui1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Possuem as fichas de produtos qu√≠micos (FISPQ)?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="qui2_sim" name="qui2" value="sim">
                                        <label for="qui2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="qui2_nao" name="qui2" value="nao">
                                        <label for="qui2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="qui2_na" name="qui2" value="na">
                                        <label for="qui2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os funcion√°rios foram alertados sobre os riscos no manuseio dos produtos?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="qui3_sim" name="qui3" value="sim">
                                        <label for="qui3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="qui3_nao" name="qui3" value="nao">
                                        <label for="qui3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="qui3_na" name="qui3" value="na">
                                        <label for="qui3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="maquinas" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">As m√°quinas e equipamentos est√£o em bom estado de conserva√ß√£o?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="maq1_sim" name="maq1" value="sim">
                                        <label for="maq1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="maq1_nao" name="maq1" value="nao">
                                        <label for="maq1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="maq1_na" name="maq1" value="na">
                                        <label for="maq1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As correias, polias e transmissores de for√ßa possuem prote√ß√£o adequada?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="maq2_sim" name="maq2" value="sim">
                                        <label for="maq2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="maq2_nao" name="maq2" value="nao">
                                        <label for="maq2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="maq2_na" name="maq2" value="na">
                                        <label for="maq2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os dispositivos de seguran√ßa das m√°quinas e equipamentos funcionam corretamente?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="maq3_sim" name="maq3" value="sim">
                                        <label for="maq3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="maq3_nao" name="maq3" value="nao">
                                        <label for="maq3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="maq3_na" name="maq3" value="na">
                                        <label for="maq3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="ferramentas" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">A limpeza das ferramentas manuais √© realizada periodicamente?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="fer1_sim" name="fer1" value="sim">
                                        <label for="fer1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer1_nao" name="fer1" value="nao">
                                        <label for="fer1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer1_na" name="fer1" value="na">
                                        <label for="fer1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">√â evitado o uso inadequado ou improvisado das ferramentas e equipamentos?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="fer2_sim" name="fer2" value="sim">
                                        <label for="fer2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer2_nao" name="fer2" value="nao">
                                        <label for="fer2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer2_na" name="fer2" value="na">
                                        <label for="fer2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As caixas de ferramentas est√£o em boas condi√ß√µes?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="fer3_sim" name="fer3" value="sim">
                                        <label for="fer3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer3_nao" name="fer3" value="nao">
                                        <label for="fer3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer3_na" name="fer3" value="na">
                                        <label for="fer3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Ao t√©rmino do servi√ßo todas as ferramentas s√£o guardadas em local apropriado?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="fer4_sim" name="fer4" value="sim">
                                        <label for="fer4_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer4_nao" name="fer4" value="nao">
                                        <label for="fer4_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="fer4_na" name="fer4" value="na">
                                        <label for="fer4_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="armazenamento" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Os materiais est√£o empilhados ou ordenados adequadamente?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="arm1_sim" name="arm1" value="sim">
                                        <label for="arm1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="arm1_nao" name="arm1" value="nao">
                                        <label for="arm1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="arm1_na" name="arm1" value="na">
                                        <label for="arm1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="uniformes" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Os empregados possuem uniformes limpos e em bom estado de conserva√ß√£o?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="uni1_sim" name="uni1" value="sim">
                                        <label for="uni1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="uni1_nao" name="uni1" value="nao">
                                        <label for="uni1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="uni1_na" name="uni1" value="na">
                                        <label for="uni1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">O local possui estoque suficiente para atender as necessidades dos empregados?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="uni2_sim" name="uni2" value="sim">
                                        <label for="uni2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="uni2_nao" name="uni2" value="nao">
                                        <label for="uni2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="uni2_na" name="uni2" value="na">
                                        <label for="uni2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="pisos" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Os pisos apresentam uma superf√≠cie segura para o trabalhador, sem buracos e se poss√≠vel com antiderrapante?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="pis1_sim" name="pis1" value="sim">
                                        <label for="pis1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="pis1_nao" name="pis1" value="nao">
                                        <label for="pis1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="pis1_na" name="pis1" value="na">
                                        <label for="pis1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">O piso est√° livre de obst√°culos?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="pis2_sim" name="pis2" value="sim">
                                        <label for="pis2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="pis2_nao" name="pis2" value="nao">
                                        <label for="pis2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="pis2_na" name="pis2" value="na">
                                        <label for="pis2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">O piso est√° claramente demarcado em seus locais de risco?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="pis3_sim" name="pis3" value="sim">
                                        <label for="pis3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="pis3_nao" name="pis3" value="nao">
                                        <label for="pis3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="pis3_na" name="pis3" value="na">
                                        <label for="pis3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="organizacao" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Os locais de trabalho est√£o organizados, livres de sujeiras e de materiais?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="org1_sim" name="org1" value="sim">
                                        <label for="org1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="org1_nao" name="org1" value="nao">
                                        <label for="org1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="org1_na" name="org1" value="na">
                                        <label for="org1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As sucatas est√£o em locais inadequados?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="org2_sim" name="org2" value="sim">
                                        <label for="org2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="org2_nao" name="org2" value="nao">
                                        <label for="org2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="org2_na" name="org2" value="na">
                                        <label for="org2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">O local possui vasilhames para coleta seletiva de lixo?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="org3_sim" name="org3" value="sim">
                                        <label for="org3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="org3_nao" name="org3" value="nao">
                                        <label for="org3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="org3_na" name="org3" value="na">
                                        <label for="org3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="escadas" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Escadas met√°licas t√™m sapatas de borracha para evitar escorreg√µes?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="esc1_sim" name="esc1" value="sim">
                                        <label for="esc1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="esc1_nao" name="esc1" value="nao">
                                        <label for="esc1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="esc1_na" name="esc1" value="na">
                                        <label for="esc1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os degraus est√£o em bom estado de condi√ß√µes de uso?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="esc2_sim" name="esc2" value="sim">
                                        <label for="esc2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="esc2_nao" name="esc2" value="nao">
                                        <label for="esc2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="esc2_na" name="esc2" value="na">
                                        <label for="esc2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="iluminacao" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">As lumin√°rias encontram-se em boas condi√ß√µes de conserva√ß√£o e limpas?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ilu1_sim" name="ilu1" value="sim">
                                        <label for="ilu1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ilu1_nao" name="ilu1" value="nao">
                                        <label for="ilu1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ilu1_na" name="ilu1" value="na">
                                        <label for="ilu1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As lumin√°rias est√£o completas e sem l√¢mpadas queimadas?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ilu2_sim" name="ilu2" value="sim">
                                        <label for="ilu2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ilu2_nao" name="ilu2" value="nao">
                                        <label for="ilu2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ilu2_na" name="ilu2" value="na">
                                        <label for="ilu2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">A ilumina√ß√£o ambiente atende a necessidade, ou √© insuficiente?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ilu3_sim" name="ilu3" value="sim">
                                        <label for="ilu3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ilu3_nao" name="ilu3" value="nao">
                                        <label for="ilu3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ilu3_na" name="ilu3" value="na">
                                        <label for="ilu3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="bebedouros" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Os bebedouros est√£o em boas condi√ß√µes de funcionamento, com √°gua pot√°vel e filtro n√£o saturado?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="beb1_sim" name="beb1" value="sim">
                                        <label for="beb1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="beb1_nao" name="beb1" value="nao">
                                        <label for="beb1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="beb1_na" name="beb1" value="na">
                                        <label for="beb1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Existem bebedouros em n√∫mero suficiente para atender os colaboradores? (01 para cada 50 trabalhadores)</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="beb2_sim" name="beb2" value="sim">
                                        <label for="beb2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="beb2_nao" name="beb2" value="nao">
                                        <label for="beb2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="beb2_na" name="beb2" value="na">
                                        <label for="beb2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Existem copos descart√°veis ou dispositivos adequados para os empregados beberem √°gua?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="beb3_sim" name="beb3" value="sim">
                                        <label for="beb3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="beb3_nao" name="beb3" value="nao">
                                        <label for="beb3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="beb3_na" name="beb3" value="na">
                                        <label for="beb3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="banheiros" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Os lavat√≥rios, mict√≥rios e sanit√°rios est√£o em boas condi√ß√µes de uso?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ban1_sim" name="ban1" value="sim">
                                        <label for="ban1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban1_nao" name="ban1" value="nao">
                                        <label for="ban1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban1_na" name="ban1" value="na">
                                        <label for="ban1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Existem banheiros e sanit√°rios suficientes para atender cada colaborador? (01 para cada 20 trabalhadores)</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ban2_sim" name="ban2" value="sim">
                                        <label for="ban2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban2_nao" name="ban2" value="nao">
                                        <label for="ban2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban2_na" name="ban2" value="na">
                                        <label for="ban2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os chuveiros e arm√°rios est√£o em boas condi√ß√µes de uso?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ban3_sim" name="ban3" value="sim">
                                        <label for="ban3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban3_nao" name="ban3" value="nao">
                                        <label for="ban3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban3_na" name="ban3" value="na">
                                        <label for="ban3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os banheiros e vesti√°rios s√£o higienizados corretamente?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ban4_sim" name="ban4" value="sim">
                                        <label for="ban4_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban4_nao" name="ban4" value="nao">
                                        <label for="ban4_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ban4_na" name="ban4" value="na">
                                        <label for="ban4_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="inflamaveis" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Os dep√≥sitos de inflam√°veis e combust√≠veis est√£o devidamente identificados e sinalizados?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inf1_sim" name="inf1" value="sim">
                                        <label for="inf1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf1_nao" name="inf1" value="nao">
                                        <label for="inf1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf1_na" name="inf1" value="na">
                                        <label for="inf1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os cilindros s√£o armazenados de forma adequada (em p√©, com capacete de prote√ß√£o, separados por conte√∫do e amarrados por correntes ou cordas)?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inf2_sim" name="inf2" value="sim">
                                        <label for="inf2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf2_nao" name="inf2" value="nao">
                                        <label for="inf2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf2_na" name="inf2" value="na">
                                        <label for="inf2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os conjuntos de oxi-corte possuem v√°lvulas contra retrocesso de chama?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inf3_sim" name="inf3" value="sim">
                                        <label for="inf3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf3_nao" name="inf3" value="nao">
                                        <label for="inf3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf3_na" name="inf3" value="na">
                                        <label for="inf3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os cilindros s√£o armazenados longe de fontes de calor?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="inf4_sim" name="inf4" value="sim">
                                        <label for="inf4_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf4_nao" name="inf4" value="nao">
                                        <label for="inf4_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="inf4_na" name="inf4" value="na">
                                        <label for="inf4_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="eletricidade" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">As tomadas, caixas e pain√©is el√©tricos possuem indica√ß√£o de voltagem?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ele1_sim" name="ele1" value="sim">
                                        <label for="ele1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ele1_nao" name="ele1" value="nao">
                                        <label for="ele1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ele1_na" name="ele1" value="na">
                                        <label for="ele1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As exig√™ncias m√≠nimas da NR 10 est√£o sendo cumpridas (equipamentos / instala√ß√µes)?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                                                                <label for="ele2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ele2_nao" name="ele2" value="nao">
                                        <label for="ele2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ele2_na" name="ele2" value="na">
                                        <label for="ele2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">A edifica√ß√£o possui aterramento el√©trico?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ele3_sim" name="ele3" value="sim">
                                        <label for="ele3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ele3_nao" name="ele3" value="nao">
                                        <label for="ele3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ele3_na" name="ele3" value="na">
                                        <label for="ele3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="escritorio" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">As passagens entre m√°quinas e m√≥veis est√£o livres e desimpedidas?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="escr1_sim" name="escr1" value="sim">
                                        <label for="escr1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr1_nao" name="escr1" value="nao">
                                        <label for="escr1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr1_na" name="escr1" value="na">
                                        <label for="escr1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os fios de m√°quinas e de telefones est√£o em boas condi√ß√µes e fora das passagens?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="escr2_sim" name="escr2" value="sim">
                                        <label for="escr2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr2_nao" name="escr2" value="nao">
                                        <label for="escr2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr2_na" name="escr2" value="na">
                                        <label for="escr2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As cadeiras e mesas est√£o com p√©s em bom estado?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="escr3_sim" name="escr3" value="sim">
                                        <label for="escr3_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr3_nao" name="escr3" value="nao">
                                        <label for="escr3_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr3_na" name="escr3" value="na">
                                        <label for="escr3_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">Os ventiladores possuem grade de prote√ß√£o?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="escr4_sim" name="escr4" value="sim">
                                        <label for="escr4_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr4_nao" name="escr4" value="nao">
                                        <label for="escr4_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr4_na" name="escr4" value="na">
                                        <label for="escr4_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As salas s√£o bem ventiladas e disp√µem de climatiza√ß√£o agrad√°vel?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="escr5_sim" name="escr5" value="sim">
                                        <label for="escr5_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr5_nao" name="escr5" value="nao">
                                        <label for="escr5_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr5_na" name="escr5" value="na">
                                        <label for="escr5_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As telas dos computadores est√£o na altura correta?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="escr6_sim" name="escr6" value="sim">
                                        <label for="escr6_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr6_nao" name="escr6" value="nao">
                                        <label for="escr6_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr6_na" name="escr6" value="na">
                                        <label for="escr6_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">As cadeiras possuem descanso para bra√ßos?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="escr7_sim" name="escr7" value="sim">
                                        <label for="escr7_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr7_nao" name="escr7" value="nao">
                                        <label for="escr7_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="escr7_na" name="escr7" value="na">
                                        <label for="escr7_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="fichaEPI" class="checklist-content">
                            <div class="checklist-question">
                                <div class="question-text">Possui ficha de controle de EPIs?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ficha1_sim" name="ficha1" value="sim">
                                        <label for="ficha1_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ficha1_nao" name="ficha1" value="nao">
                                        <label for="ficha1_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ficha1_na" name="ficha1" value="na">
                                        <label for="ficha1_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="checklist-question">
                                <div class="question-text">A ficha de controle de EPIs est√° em dia?</div>
                                <div class="answer-options">
                                    <div class="answer-option">
                                        <input type="radio" id="ficha2_sim" name="ficha2" value="sim">
                                        <label for="ficha2_sim">Sim</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ficha2_nao" name="ficha2" value="nao">
                                        <label for="ficha2_nao">N√£o</label>
                                    </div>
                                    <div class="answer-option">
                                        <input type="radio" id="ficha2_na" name="ficha2" value="na">
                                        <label for="ficha2_na">N/A</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Resumo do checklist -->
                        <div class="checklist-summary">
                            <div class="summary-title">Resumo do Checklist de Seguran√ßa</div>
                            <div class="summary-stats">
                                <div class="summary-stat">
                                    <span class="summary-stat-value" id="totalQuestions">0</span>
                                    <span class="summary-stat-label">Total de Perguntas</span>
                                </div>
                                <div class="summary-stat">
                                    <span class="summary-stat-value" id="answeredQuestions">0</span>
                                    <span class="summary-stat-label">Respondidas</span>
                                </div>
                                <div class="summary-stat">
                                    <span class="summary-stat-value" id="yesAnswers">0</span>
                                    <span class="summary-stat-label">Sim</span>
                                </div>
                                <div class="summary-stat">
                                    <span class="summary-stat-value" id="noAnswers">0</span>
                                    <span class="summary-stat-label">N√£o</span>
                                </div>
                            </div>
                            <div class="summary-score" id="summaryScore">
                                Pontua√ß√£o: 0%
                            </div>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary pulse" id="submitBtn">
                            üíæ Salvar Inspe√ß√£o
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="resetForm()">
                            üîÑ Limpar Formul√°rio
                        </button>
                    </div>
                </form>
            </div>

            <div class="card">
                <h2 class="card-title">üìã Hist√≥rico de Inspe√ß√µes</h2>
                <div class="filter-tabs">
                    <button class="filter-tab active" onclick="filterInspections('all')">Todas</button>
                    <button class="filter-tab" onclick="filterInspections('pending')">Pendentes</button>
                    <button class="filter-tab" onclick="filterInspections('completed')">Conclu√≠das</button>
                </div>
                <div class="history-container" id="historyContainer">
                    <div class="empty-history">
                        <div class="empty-history-icon">üì≠</div>
                        <p>Nenhuma inspe√ß√£o registrada ainda</p>
                        <p style="font-size: 14px; margin-top: 10px;">Comece adicionando sua primeira inspe√ß√£o</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Edi√ß√£o de Foto -->
    <div class="modal" id="photoEditorModal">
        <div class="modal-content" style="max-width: 90%;">
            <div class="modal-header">
                <h3 class="modal-title">Editar Foto</h3>
                <button class="close-modal" onclick="closePhotoEditor()">&times;</button>
            </div>
            <div class="image-editor">
                <canvas id="editorCanvas" class="editor-canvas"></canvas>
                <div class="editor-toolbar">
                    <button class="editor-tool" onclick="setEditorTool('arrow')" id="arrowTool">
                        ‚û°Ô∏è Seta
                    </button>
                    <button class="editor-tool" onclick="setEditorTool('circle')" id="circleTool">
                        ‚≠ï C√≠rculo
                    </button>
                    <button class="editor-tool" onclick="setEditorTool('rectangle')" id="rectangleTool">
                        ‚¨ú Ret√¢ngulo
                    </button>
                    <button class="editor-tool" onclick="setEditorTool('text')" id="textTool">
                        üî§ Texto
                    </button>
                    <input type="color" class="color-picker" id="colorPicker" value="#ff0000">
                    <button class="editor-tool" onclick="clearAnnotations()" title="Desfazer √∫ltima anota√ß√£o">
                        ‚Ü©Ô∏è Desfazer
                    </button>
                    <button class="editor-tool" onclick="saveEditedPhoto()" style="background: var(--success);">
                        ‚úÖ Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes da Inspe√ß√£o -->
    <div class="modal" id="inspectionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Detalhes da Inspe√ß√£o</h3>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Modal de Risco da Foto -->
    <div class="modal" id="photoRiskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Definir Risco da Foto</h3>
                <button class="close-modal" onclick="closePhotoRiskModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>N√≠vel de Risco</label>
                <div class="risk-levels">
                    <button type="button" class="risk-btn low" onclick="setPhotoRisk('low')">
                        ‚úÖ Baixo
                    </button>
                    <button type="button" class="risk-btn medium" onclick="setPhotoRisk('medium')">
                        ‚ö†Ô∏è M√©dio
                    </button>
                    <button type="button" class="risk-btn high" onclick="setPhotoRisk('high')">
                        üö® Alto
                    </button>
                </div>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="hasPhotoDeadline" onchange="toggleDeadlineField()">
                    Definir data limite para resolu√ß√£o
                </label>
                <input type="date" id="photoDeadline" style="display: none; margin-top: 8px;">
            </div>
            <div class="form-group">
                <label for="photoDescription">Descri√ß√£o da Foto</label>
                <textarea id="photoDescription" placeholder="Descreva o que esta foto mostra..."></textarea>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="savePhotoRisk()">
                    üíæ Salvar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Resolu√ß√£o de Foto -->
    <div class="modal" id="photoResolutionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Resolver Foto</h3>
                <button class="close-modal" onclick="closePhotoResolutionModal()">&times;</button>
            </div>
            <div id="resolutionModalBody"></div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // =================================================================
        // SISTEMA DE SINCRONIZA√á√ÉO EM REDE
        // =================================================================
        
        // Configura√ß√£o de rede
        let networkConfig = {
            serverUrl: '',
            syncInterval: 30,
            apiKey: '',
            dataPath: '/data/inspections.json',
            lastSync: null,
            syncEnabled: false,
            syncTimer: null
        };

        // Carregar configura√ß√£o de rede do localStorage
        function loadNetworkConfig() {
            const saved = localStorage.getItem('networkConfig');
            if (saved) {
                networkConfig = { ...networkConfig, ...JSON.parse(saved) };
                updateNetworkConfigUI();
            }
        }

        // Salvar configura√ß√£o de rede
        function saveNetworkConfigToStorage() {
            localStorage.setItem('networkConfig', JSON.stringify(networkConfig));
        }

        // Atualizar UI com configura√ß√£o atual
        function updateNetworkConfigUI() {
            document.getElementById('serverUrl').value = networkConfig.serverUrl;
            document.getElementById('syncInterval').value = networkConfig.syncInterval;
            document.getElementById('apiKey').value = networkConfig.apiKey;
            document.getElementById('dataPath').value = networkConfig.dataPath;
        }

        // Toggle painel de configura√ß√£o
        function toggleNetworkConfig() {
            const configPanel = document.getElementById('networkConfig');
            configPanel.classList.toggle('active');
        }

        // Salvar configura√ß√£o de rede
        function saveNetworkConfig() {
            networkConfig.serverUrl = document.getElementById('serverUrl').value;
            networkConfig.syncInterval = parseInt(document.getElementById('syncInterval').value);
            networkConfig.apiKey = document.getElementById('apiKey').value;
            networkConfig.dataPath = document.getElementById('dataPath').value;
            
            saveNetworkConfigToStorage();
            
            if (networkConfig.serverUrl) {
                networkConfig.syncEnabled = true;
                startAutoSync();
                showToast('Configura√ß√£o de rede salva e sincroniza√ß√£o ativada!', 'success');
            } else {
                networkConfig.syncEnabled = false;
                stopAutoSync();
                showToast('Configura√ß√£o salva. Sincroniza√ß√£o desativada (URL do servidor n√£o definida).', 'info');
            }
            
            toggleNetworkConfig();
        }

        // Testar conex√£o com o servidor
        async function testConnection() {
            const serverUrl = document.getElementById('serverUrl').value;
            if (!serverUrl) {
                showToast('Por favor, insira a URL do servidor', 'error');
                return;
            }

            try {
                updateSyncStatus('syncing', 'Testando conex√£o...');
                
                const response = await fetch(`${serverUrl}/test`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': document.getElementById('apiKey').value || ''
                    }
                });

                if (response.ok) {
                    updateSyncStatus('success', 'Conex√£o bem-sucedida!');
                    showToast('Conex√£o com o servidor estabelecida com sucesso!', 'success');
                } else {
                    throw new Error(`Erro ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                updateSyncStatus('error', 'Falha na conex√£o');
                showToast(`Falha ao conectar: ${error.message}`, 'error');
            }
        }

        // Iniciar sincroniza√ß√£o autom√°tica
        function startAutoSync() {
            if (networkConfig.syncTimer) {
                clearInterval(networkConfig.syncTimer);
            }
            
            if (networkConfig.syncEnabled && networkConfig.serverUrl) {
                networkConfig.syncTimer = setInterval(() => {
                    syncData();
                }, networkConfig.syncInterval * 1000);
                
                updateSyncStatus('success', `Sincroniza√ß√£o autom√°tica ativa (${networkConfig.syncInterval}s)`);
            }
        }

        // Parar sincroniza√ß√£o autom√°tica
        function stopAutoSync() {
            if (networkConfig.syncTimer) {
                clearInterval(networkConfig.syncTimer);
                networkConfig.syncTimer = null;
            }
            updateSyncStatus('', 'Sincroniza√ß√£o: Desativada');
        }

        // Atualizar status de sincroniza√ß√£o na UI
        function updateSyncStatus(status, message) {
            const statusElement = document.getElementById('syncStatus');
            const messageElement = document.getElementById('syncMessage');
            
            statusElement.className = 'sync-status';
            if (status) {
                statusElement.classList.add(status);
            }
            messageElement.textContent = message;
        }

        // Sincronizar dados com o servidor
        async function syncData() {
            if (!networkConfig.syncEnabled || !networkConfig.serverUrl) {
                return;
            }

            try {
                updateSyncStatus('syncing', 'Sincronizando...');
                
                // Obter dados locais
                const localData = {
                    inspections: inspections,
                    lastModified: new Date().toISOString()
                };

                // Enviar para o servidor
                const response = await fetch(`${networkConfig.serverUrl}${networkConfig.dataPath}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': networkConfig.apiKey || ''
                    },
                    body: JSON.stringify(localData)
                });

                if (!response.ok) {
                    throw new Error(`Erro ${response.status}: ${response.statusText}`);
                }

                // Obter dados atualizados do servidor
                const serverResponse = await fetch(`${networkConfig.serverUrl}${networkConfig.dataPath}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': networkConfig.apiKey || ''
                    }
                });

                if (serverResponse.ok) {
                    const serverData = await serverResponse.json();
                    
                    // Mesclar dados (priorizar dados mais recentes)
                    if (serverData.inspections && Array.isArray(serverData.inspections)) {
                        // Implementar l√≥gica de mesclagem aqui
                        // Por enquanto, vamos substituir completamente
                        inspections = serverData.inspections;
                        renderInspections();
                        updateStats();
                    }
                }

                networkConfig.lastSync = new Date().toISOString();
                updateSyncStatus('success', `Sincronizado em ${new Date().toLocaleTimeString('pt-BR')}`);
                
            } catch (error) {
                console.error('Erro na sincroniza√ß√£o:', error);
                updateSyncStatus('error', 'Falha na sincroniza√ß√£o');
                showToast(`Erro na sincroniza√ß√£o: ${error.message}`, 'error');
            }
        }

        // =================================================================
        // BLOCO DE C√ìDIGO CORRIGIDO - EDITOR DE FOTOS
        // =================================================================

        // Objeto para gerenciar o estado do editor de fotos
        const PhotoEditor = {
            canvas: null,
            ctx: null,
            img: null,
            isDrawing: false,
            startX: 0,
            startY: 0,
            currentAnnotation: null,
            annotations: [],
            tool: 'arrow',
            color: '#ff0000',

            // Inicializa o editor com uma imagem
            async init(canvasId, imageSrc) {
                this.canvas = document.getElementById(canvasId);
                if (!this.canvas) {
                    console.error("Canvas n√£o encontrado.");
                    return false;
                }
                this.ctx = this.canvas.getContext('2d');

                try {
                    await this.loadImage(imageSrc);
                    this.setupEvents();
                    return true;
                } catch (error) {
                    console.error("Falha ao inicializar o PhotoEditor:", error);
                    return false;
                }
            },

            // Carrega a imagem no canvas
            loadImage(src) {
                return new Promise((resolve, reject) => {
                    this.img = new Image();
                    
                    this.img.onload = () => {
                        console.log('Imagem carregada. Dimens√µes:', this.img.width, 'x', this.img.height);
                        
                        // 1. Redefine o tamanho do canvas para o tamanho da imagem
                        this.canvas.width = this.img.width;
                        this.canvas.height = this.img.height;
                        
                        // 2. Limpa o canvas completamente
                        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                        
                        // 3. Desenha a imagem no canvas
                        this.ctx.drawImage(this.img, 0, 0);
                        
                        // 4. Redesenha as anota√ß√µes por cima
                        this.annotations.forEach(ann => this.drawAnnotation(ann));
                        
                        console.log('Canvas atualizado com a imagem e anota√ß√µes.');
                        resolve();
                    };

                    this.img.onerror = (error) => {
                        console.error("Erro ao carregar a imagem para o editor:", error);
                        reject(error);
                    };

                    // Inicia o carregamento da imagem
                    this.img.src = src;
                });
            },

            // Redesenha a imagem e todas as anota√ß√µes
            redraw() {
                if (!this.img) return;
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.drawImage(this.img, 0, 0);
                this.annotations.forEach(ann => this.drawAnnotation(ann));
            },

            // Configura os eventos de mouse para o canvas
            setupEvents() {
                // Remove listeners antigos para evitar duplicatas
                const newCanvas = this.canvas.cloneNode(true);
                this.canvas.parentNode.replaceChild(newCanvas, this.canvas);
                this.canvas = newCanvas;
                this.ctx = this.canvas.getContext('2d');

                // Eventos de mouse
                this.canvas.onmousedown = (e) => this.startDrawing(e);
                this.canvas.onmousemove = (e) => this.draw(e);
                this.canvas.onmouseup = () => this.stopDrawing();
                this.canvas.onmouseleave = () => this.stopDrawing();
            },

            // Inicia o desenho de uma anota√ß√£o
            startDrawing(e) {
                this.isDrawing = true;
                const coords = this.getCoordinates(e);
                this.startX = coords.x;
                this.startY = coords.y;

                this.currentAnnotation = {
                    type: this.tool,
                    startX: this.startX,
                    startY: this.startY,
                    endX: this.startX,
                    endY: this.startY,
                    color: this.color,
                    text: this.tool === 'text' ? 'Texto' : null
                };
            },

            // Desenha a anota√ß√£o enquanto o mouse se move
            draw(e) {
                if (!this.isDrawing || !this.currentAnnotation) return;
                const coords = this.getCoordinates(e);
                this.currentAnnotation.endX = coords.x;
                this.currentAnnotation.endY = coords.y;

                this.redraw(); // Redesenha tudo
                this.drawAnnotation(this.currentAnnotation); // Desenha a anota√ß√£o atual por cima
            },

            // Finaliza o desenho e salva a anota√ß√£o
            stopDrawing() {
                if (!this.isDrawing || !this.currentAnnotation) return;
                this.isDrawing = false;

                if (this.tool === 'text') {
                    const text = prompt("Digite o texto:", "Texto");
                    if (text !== null) {
                        this.currentAnnotation.text = text;
                    } else {
                        this.redraw(); // Cancela se n√£o houver texto
                        this.currentAnnotation = null;
                        return;
                    }
                }

                this.annotations.push(this.currentAnnotation);
                this.redraw();
                this.currentAnnotation = null;
            },

            // Desenha uma anota√ß√£o espec√≠fica no canvas
            drawAnnotation(annotation) {
                this.ctx.strokeStyle = annotation.color;
                this.ctx.lineWidth = 3;
                this.ctx.fillStyle = annotation.color;
                this.ctx.font = '16px Arial';

                switch (annotation.type) {
                    case 'arrow':
                        this.drawArrow(annotation.startX, annotation.startY, annotation.endX, annotation.endY);
                        break;
                    case 'circle': {
                        const radiusX = Math.abs(annotation.endX - annotation.startX);
                        const radiusY = Math.abs(annotation.endY - annotation.startY);
                        this.ctx.beginPath();
                        this.ctx.ellipse(annotation.startX, annotation.startY, radiusX, radiusY, 0, 0, 2 * Math.PI);
                        this.ctx.stroke();
                        break;
                    }
                    case 'rectangle':
                        this.ctx.strokeRect(
                            annotation.startX,
                            annotation.startY,
                            annotation.endX - annotation.startX,
                            annotation.endY - annotation.startY
                        );
                        break;
                    case 'text':
                        if (annotation.text) {
                            this.ctx.fillText(annotation.text, annotation.startX, annotation.startY);
                        }
                        break;
                }
            },

            // Desenha uma seta
            drawArrow(fromX, fromY, toX, toY) {
                const headLength = 15;
                const angle = Math.atan2(toY - fromY, toX - fromX);

                this.ctx.beginPath();
                this.ctx.moveTo(fromX, fromY);
                this.ctx.lineTo(toX, toY);
                this.ctx.stroke();

                this.ctx.beginPath();
                this.ctx.moveTo(toX, toY);
                this.ctx.lineTo(toX - headLength * Math.cos(angle - Math.PI / 6), toY - headLength * Math.sin(angle - Math.PI / 6));
                this.ctx.moveTo(toX, toY);
                this.ctx.lineTo(toX - headLength * Math.cos(angle + Math.PI / 6), toY - headLength * Math.sin(angle + Math.PI / 6));
                this.ctx.stroke();
            },

            // Obt√©m as coordenadas do mouse relativas ao canvas
            getCoordinates(e) {
                const rect = this.canvas.getBoundingClientRect();
                return {
                    x: (e.clientX - rect.left) * (this.canvas.width / rect.width),
                    y: (e.clientY - rect.top) * (this.canvas.height / rect.height)
                };
            },

            // Define a ferramenta de desenho atual
            setTool(tool) {
                this.tool = tool;
                document.querySelectorAll('.editor-tool').forEach(btn => btn.classList.remove('active'));
                document.getElementById(tool + 'Tool')?.classList.add('active');
            },

            // Limpa a √∫ltima anota√ß√£o
            undo() {
                if (this.annotations.length > 0) {
                    this.annotations.pop();
                    this.redraw();
                    showToast('√öltima anota√ß√£o removida', 'success');
                } else {
                    showToast('Nenhuma anota√ß√£o para remover', 'info');
                }
            }
        };

        // =================================================================
        // FUN√á√ïES GLOBAIS DO EDITOR (Chamadas pelos bot√µes na UI)
        // =================================================================

        // Fun√ß√£o chamada ao clicar em "Editar Foto"
        async function editPhoto(event, index) {
            event.stopPropagation();
            if (index === undefined || index === null || !photos || !photos[index]) {
                showToast('Erro ao editar foto: foto n√£o encontrada.', 'error');
                return;
            }

            // Define as vari√°veis globais para o contexto de edi√ß√£o
            currentEditingPhoto = JSON.parse(JSON.stringify(photos[index]));
            currentPhotoIndex = index;

            // Abre o modal e inicializa o editor
            const modal = document.getElementById('photoEditorModal');
            modal.classList.add('active');

            const success = await PhotoEditor.init('editorCanvas', currentEditingPhoto.src);
            if (!success) {
                showToast('Ocorreu um erro ao abrir o editor de fotos.', 'error');
                closePhotoEditor();
                return;
            }

            // Define a ferramenta e cor iniciais
            PhotoEditor.setTool(editorTool);
            PhotoEditor.color = document.getElementById('colorPicker').value;
        }

        // Fun√ß√£o para salvar a foto editada
        function saveEditedPhoto() {
            if (currentPhotoIndex === undefined || currentPhotoIndex === null || !photos || !photos[currentPhotoIndex]) {
                showToast('Erro interno: Foto n√£o encontrada. Tente novamente.', 'error');
                return;
            }

            try {
                // Pega a imagem do canvas como DataURL
                const editedImageData = PhotoEditor.canvas.toDataURL('image/png');
                
                // Atualiza a foto no array com a nova imagem e as anota√ß√µes
                photos[currentPhotoIndex].src = editedImageData;
                photos[currentPhotoIndex].annotations = [...PhotoEditor.annotations];
                
                renderPhotoGallery();
                closePhotoEditor();
                
                if (!currentEditingInspectionId) {
                    saveFormState();
                }
                
                // Sincroniza com a rede se estiver ativo
                if (networkConfig.syncEnabled) {
                    syncData();
                }
                
                showToast('Foto editada com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao salvar a foto editada:', error);
                showToast('Ocorreu um erro ao salvar a foto. Tente novamente.', 'error');
            }
        }

        // Fun√ß√£o para fechar o editor
        function closePhotoEditor() {
            document.getElementById('photoEditorModal').classList.remove('active');
            // Limpa o estado do editor para a pr√≥xima vez
            PhotoEditor.annotations = [];
            PhotoEditor.currentAnnotation = null;
            PhotoEditor.isDrawing = false;
        }

        // Fun√ß√µes chamadas pelos bot√µes da barra de ferramentas
        function setEditorTool(tool) {
            editorTool = tool;
            PhotoEditor.setTool(tool);
        }

        function clearAnnotations() {
            PhotoEditor.undo();
        }

        // Garante que o seletor de cor atualize a cor do editor
        document.getElementById('colorPicker').addEventListener('change', (e) => {
            PhotoEditor.color = e.target.value;
        });

        // =================================================================
        // RESTO DO C√ìDIGO JAVASCRIPT
        // =================================================================

        // Vari√°veis globais
        let selectedRiskLevel = null;
        let photos = [];
        let inspections = [];
        let currentEditingPhoto = null;
        let currentPhotoIndex = null;
        let currentInspectionId = null;
        let currentPhotoId = null;
        let editorTool = 'arrow';
        let currentPhotoRisk = null;
        let currentFilter = 'all';
        let currentEditingInspectionId = null;
        
        // Armazenamento em mem√≥ria para o checklist
        let checklistMemory = {};
        
        // Sistema de backup autom√°tico
        let backupInterval;
        const BACKUP_INTERVAL = 30000; // 30 segundos
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            loadNetworkConfig(); // Carregar configura√ß√£o de rede primeiro
            loadDataFromStorage();
            
            try {
                const formState = localStorage.getItem('formState');
                if (formState) {
                    const state = JSON.parse(formState);
                    
                    document.getElementById('areaName').value = state.areaName || '';
                    document.getElementById('inspectionDate').value = state.inspectionDate || '';
                    document.getElementById('deadlineDate').value = state.deadlineDate || '';
                    document.getElementById('location').value = state.location || '';
                    document.getElementById('observations').value = state.observations || '';
                    
                    if (state.selectedRiskLevel) {
                        setRiskLevel(state.selectedRiskLevel);
                    }
                    
                    if (state.photos && Array.isArray(state.photos)) {
                        photos = state.photos;
                    }
                    
                    if (state.areaPhoto) {
                        document.getElementById('areaPhotoGallery').innerHTML = `
                            <div class="photo-item">
                                <img src="${state.areaPhoto}" alt="Foto da √Årea">
                                <div class="photo-actions">
                                    <button class="photo-action-btn" onclick="deleteAreaPhoto(event, this)">
                                        üóëÔ∏è
                                    </button>
                                </div>
                            </div>
                            <div class="add-photo-btn" onclick="addAreaPhoto()">
                                <span>üì∑</span>
                                <small>Adicionar mais fotos</small>
                            </div>
                        `;
                    }
                    
                    if (state.checklistMemory && typeof state.checklistMemory === 'object') {
                        checklistMemory = state.checklistMemory;
                    }
                    
                    console.log('Estado do formul√°rio restaurado com sucesso.');
                } else {
                    const today = new Date();
                    document.getElementById('inspectionDate').valueAsDate = today;
                    const deadline = new Date(today);
                    deadline.setDate(deadline.getDate() + 30);
                    document.getElementById('deadlineDate').valueAsDate = deadline;
                }
            } catch (error) {
                console.error('Erro ao restaurar estado do formul√°rio:', error);
                localStorage.removeItem('formState');
            }
            
            renderInspections();
            updateStats();
            setupEventListeners();
            renderPhotoGallery();
            applyChecklistStateToDOM();
            updateChecklistSummary();
            startAutoBackup();
            
            // Iniciar sincroniza√ß√£o autom√°tica se configurado
            if (networkConfig.syncEnabled) {
                startAutoSync();
            }
        }

        // Modificar fun√ß√£o saveInspections para incluir sincroniza√ß√£o
        function saveInspections() {
            try {
                const inspectionsData = JSON.stringify(inspections);
                localStorage.setItem('inspections', inspectionsData);
                
                // Limpa o estado do formul√°rio ap√≥s um salvamento bem-sucedido
                localStorage.removeItem('formState'); 
                localStorage.setItem('inspections_last_save', new Date().toISOString());
                
                console.log('Inspe√ß√µes salvas com sucesso:', inspections.length);
                
                // Sincronizar com a rede se estiver ativo
                if (networkConfig.syncEnabled) {
                    syncData();
                }
                
                return true;
            } catch (error) {
                console.error('Erro ao salvar inspe√ß√µes:', error);
                
                // Verifica se o erro √© de estouro de cota do localStorage
                if (error.name === 'QuotaExceededError' || error.code === 22) {
                    showToast('Erro: Espa√ßo de armazenamento cheio. Tente excluir algumas inspe√ß√µes com muitas fotos ou limpe os dados do navegador.', 'error');
                } else {
                    showToast('Erro ao salvar inspe√ß√µes. Tente novamente.', 'error');
                }
                return false;
            }
        }

        // Modificar fun√ß√£o saveInspection para incluir sincroniza√ß√£o
        function saveInspection(e) {
            console.log('Iniciando salvamento da inspe√ß√£o...');
            
            if (currentEditingInspectionId) {
                const modalIsOpen = document.querySelector('.modal.active');
                if (modalIsOpen) {
                    console.warn('Tentativa de salvar inspe√ß√£o enquanto um modal est√° aberto. Opera√ß√£o cancelada para evitar perda de dados.');
                    showToast('Por favor, feche a janela de edi√ß√£o de foto antes de salvar a inspe√ß√£o.', 'error');
                    if (e) e.preventDefault();
                    return;
                }
            }

            const areaName = document.getElementById('areaName').value.trim();
            const inspectionDate = document.getElementById('inspectionDate').value;
            const deadlineDate = document.getElementById('deadlineDate').value;
            
            if (!areaName) {
                showToast('Por favor, preencha o nome da √°rea', 'error');
                if (e) e.preventDefault();
                return;
            }
            
            if (!inspectionDate) {
                showToast('Por favor, selecione a data da inspe√ß√£o', 'error');
                if (e) e.preventDefault();
                return;
            }
            
            if (!deadlineDate) {
                showToast('Por favor, defina o prazo para conclus√£o', 'error');
                if (e) e.preventDefault();
                return;
            }
            
            if (!selectedRiskLevel) {
                showToast('Por favor, selecione um n√≠vel de risco geral', 'error');
                if (e) e.preventDefault();
                return;
            }

            if (photos.length === 0) {
                showToast('Por favor, adicione pelo menos uma foto', 'error');
                if (e) e.preventDefault();
                return;
            }
            
            const areaPhotoGallery = document.getElementById('areaPhotoGallery');
            const areaPhoto = areaPhotoGallery.querySelector('img') ? 
                areaPhotoGallery.querySelector('img').src : null;
                
            const finalChecklistData = collectChecklistData();
            console.log('Dados finais do checklist coletados:', finalChecklistData);
            
            if (currentEditingInspectionId) {
                updateInspection(currentEditingInspectionId);
            } else {
                const inspection = {
                    id: Date.now(),
                    areaName: areaName,
                    areaPhoto: areaPhoto,
                    date: inspectionDate,
                    deadlineDate: deadlineDate,
                    location: document.getElementById('location').value,
                    riskLevel: selectedRiskLevel,
                    observations: document.getElementById('observations').value,
                    photos: photos,
                    checklistData: finalChecklistData,
                    status: calculateInspectionStatus(photos),
                    completionPercentage: calculateCompletionPercentage(photos),
                    timestamp: new Date().toISOString(),
                    modifiedBy: getCurrentUser(), // Adicionar usu√°rio atual
                    syncStatus: 'pending' // Status de sincroniza√ß√£o
                };
                
                console.log('Nova inspe√ß√£o criada:', inspection);
                
                inspections.unshift(inspection);
                
                if (saveInspections()) {
                    showToast('Inspe√ß√£o salva com sucesso!', 'success');
                    resetForm();
                    renderInspections();
                    updateStats();
                    localStorage.setItem('inspections_last_update', new Date().toISOString());
                    document.querySelector('.history-container').classList.add('success-animation');
                    setTimeout(() => {
                        document.querySelector('.history-container').classList.remove('success-animation');
                    }, 500);
                }
            }
        }

        // Fun√ß√£o para obter usu√°rio atual (pode ser personalizada)
        function getCurrentUser() {
            // Em um ambiente real, isso poderia vir de um sistema de autentica√ß√£o
            return localStorage.getItem('currentUser') || 'Usu√°rio An√¥nimo';
        }

        // Adicionar fun√ß√£o para definir usu√°rio atual
        function setCurrentUser(username) {
            localStorage.setItem('currentUser', username);
        }

        // Continuar com o resto das fun√ß√µes existentes...
        // [Todas as outras fun√ß√µes do seu c√≥digo original continuam aqui]
        
        function setupEventListeners() {
            document.getElementById('inspectionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveInspection();
            });
            
            const formFields = document.querySelectorAll('#inspectionForm input[type="text"], #inspectionForm textarea, #inspectionForm input[type="date"]');
            formFields.forEach(field => {
                field.addEventListener('input', function() {
                    if (!currentEditingInspectionId) {
                        saveFormState();
                    }
                });
            });
            
            document.querySelectorAll('.checklist-question input[type="radio"]').forEach(input => {
                input.addEventListener('change', function() {
                    const tabId = this.closest('.checklist-content').id;
                    if (!checklistMemory[tabId]) {
                        checklistMemory[tabId] = {};
                    }
                    checklistMemory[tabId][this.name] = this.value;
                    
                    if (!currentEditingInspectionId) {
                        saveFormState();
                    }
                    
                    updateChecklistSummary();
                });
            });
            
            window.addEventListener('beforeunload', function(e) {
                const currentChecklistState = {};
                document.querySelectorAll('.checklist-question input[type="radio"]:checked').forEach(input => {
                    const tabId = input.closest('.checklist-content').id;
                    if (!currentChecklistState[tabId]) {
                        currentChecklistState[tabId] = {};
                    }
                    currentChecklistState[tabId][input.name] = input.value;
                });
                
                const formState = localStorage.getItem('formState');
                if (formState) {
                    const state = JSON.parse(formState);
                    const timeDiff = new Date() - new Date(state.timestamp);
                    const minutesDiff = timeDiff / (1000 * 60);
                    
                    if (minutesDiff < 5 && (state.areaName || state.observations || photos.length > 0)) {
                        e.preventDefault();
                        e.returnValue = '';
                    }
                }
            });
        }
        
        function loadDataFromStorage() {
            try {
                const savedInspections = localStorage.getItem('inspections');
                if (savedInspections) {
                    inspections = JSON.parse(savedInspections);
                }
                
                console.log('Dados carregados com sucesso');
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                showToast('Erro ao carregar dados salvos', 'error');
            }
        }
        
        function saveFormState() {
            if (currentEditingInspectionId) {
                console.log("Salvamento de estado do formul√°rio bloqueado durante a edi√ß√£o.");
                return;
            }
            
            try {
                const currentChecklistState = {};
                document.querySelectorAll('.checklist-question input[type="radio"]:checked').forEach(input => {
                    const tabId = input.closest('.checklist-content').id;
                    if (!currentChecklistState[tabId]) {
                        currentChecklistState[tabId] = {};
                    }
                    currentChecklistState[tabId][input.name] = input.value;
                });

                const areaPhotoGallery = document.getElementById('areaPhotoGallery');
                const areaPhotoImg = areaPhotoGallery.querySelector('img');
                const areaPhoto = areaPhotoImg ? areaPhotoImg.src : null;

                const formState = {
                    areaName: document.getElementById('areaName').value,
                    inspectionDate: document.getElementById('inspectionDate').value,
                    deadlineDate: document.getElementById('deadlineDate').value,
                    location: document.getElementById('location').value,
                    observations: document.getElementById('observations').value,
                    selectedRiskLevel: selectedRiskLevel,
                    photos: photos,
                    areaPhoto: areaPhoto,
                    checklistMemory: currentChecklistState,
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('formState', JSON.stringify(formState));
                
                updateBackupIndicator();
            } catch (error) {
                console.error('Erro ao salvar estado do formul√°rio:', error);
            }
        }
        
        function applyChecklistStateToDOM() {
            document.querySelectorAll('.checklist-question input[type="radio"]').forEach(input => {
                input.checked = false;
            });

            if (checklistMemory && typeof checklistMemory === 'object') {
                Object.keys(checklistMemory).forEach(tabId => {
                    if (checklistMemory[tabId] && typeof checklistMemory[tabId] === 'object') {
                        Object.keys(checklistMemory[tabId]).forEach(key => {
                            const value = checklistMemory[tabId][key];
                            const input = document.querySelector(`input[name="${key}"][value="${value}"]`);
                            if (input) {
                                input.checked = true;
                            }
                        });
                    }
                });
            }
        }
        
        function hasUnsavedChanges() {
            const formState = localStorage.getItem('formState');
            if (!formState) return false;
            
            const state = JSON.parse(formState);
            const timeDiff = new Date() - new Date(state.timestamp);
            const minutesDiff = timeDiff / (1000 * 60);
            
            return minutesDiff < 5 && (state.areaName || state.observations || photos.length > 0);
        }
        
        function startAutoBackup() {
            performBackup();
            backupInterval = setInterval(performBackup, BACKUP_INTERVAL);
            console.log('Backup autom√°tico iniciado');
        }
        
        function performBackup() {
            try {
                const backup = {
                    inspections: inspections,
                    formState: localStorage.getItem('formState'),
                    checklistData: localStorage.getItem('checklistData'),
                    checklistMemory: localStorage.getItem('checklistMemory'),
                    timestamp: new Date().toISOString(),
                    version: '1.0'
                };
                
                localStorage.setItem('completeBackup', JSON.stringify(backup));
                updateBackupIndicator();
                console.log('Backup autom√°tico realizado');
            } catch (error) {
                console.error('Erro no backup autom√°tico:', error);
            }
        }
        
        function updateBackupIndicator() {
            const indicator = document.querySelector('.backup-indicator');
            const status = document.getElementById('lastBackup');
            
            if (indicator && status) {
                const lastBackup = localStorage.getItem('completeBackup');
                if (lastBackup) {
                    const backup = JSON.parse(lastBackup);
                    const time = new Date(backup.timestamp);
                    status.textContent = `√öltimo backup: ${time.toLocaleTimeString('pt-BR')}`;
                    indicator.style.background = 'var(--success)';
                }
            }
        }
        
        function exportJSON() {
            const exportBtn = event.target;
            const originalText = exportBtn.innerHTML;

            exportBtn.innerHTML = '<span class="loading"></span> Gerando JSON...';
            exportBtn.disabled = true;

            try {
                const data = {
                    inspections: inspections,
                    exportDate: new Date().toISOString(),
                    version: '1.0',
                    metadata: {
                        totalInspections: inspections.length,
                        exportType: 'complete'
                    }
                };
                
                const jsonString = JSON.stringify(data);
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `inspections_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('Dados exportados com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao exportar JSON:', error);
                showToast('Erro ao exportar dados', 'error');
            } finally {
                exportBtn.innerHTML = originalText;
                exportBtn.disabled = false;
            }
        }
        
        function importJSON(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.name.toLowerCase().endsWith('.json')) {
                showToast('Por favor, selecione um arquivo JSON v√°lido', 'error');
                event.target.value = '';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    
                    let data;
                    try {
                        data = JSON.parse(content);
                    } catch (parseError) {
                        console.error('Erro ao fazer parse do JSON:', parseError);
                        showToast('Arquivo JSON inv√°lido ou mal formatado', 'error');
                        event.target.value = '';
                        return;
                    }
                    
                    let inspectionsToImport = [];
                    
                    if (data.inspections && Array.isArray(data.inspections)) {
                        inspectionsToImport = data.inspections;
                    } else if (Array.isArray(data)) {
                        inspectionsToImport = data;
                    } else {
                        showToast('Formato de arquivo JSON n√£o reconhecido. O arquivo deve conter um array de inspe√ß√µes ou um objeto com a propriedade "inspections"', 'error');
                        event.target.value = '';
                        return;
                    }
                    
                    if (inspectionsToImport.length === 0) {
                        showToast('O arquivo n√£o cont√©m nenhuma inspe√ß√£o para importar', 'error');
                        event.target.value = '';
                        return;
                    }
                    
                    for (let i = 0; i < inspectionsToImport.length; i++) {
                        const inspection = inspectionsToImport[i];
                        if (!inspection.id || !inspection.areaName || !inspection.date) {
                            showToast(`A inspe√ß√£o ${i+1} est√° incompleta ou em formato inv√°lido`, 'error');
                            event.target.value = '';
                            return;
                        }
                    }
                    
                    const confirmMessage = inspections.length > 0 
                        ? `Isso substituir√° todas as ${inspections.length} inspe√ß√µes atuais por ${inspectionsToImport.length} novas inspe√ß√µes. Deseja continuar?`
                        : `Isso importar√° ${inspectionsToImport.length} inspe√ß√µes. Deseja continuar?`;
                        
                    if (confirm(confirmMessage)) {
                        inspections = inspectionsToImport;
                        
                        localStorage.setItem('inspections', JSON.stringify(inspections));
                        
                        renderInspections();
                        updateStats();
                        
                        // Sincronizar com a rede se estiver ativo
                        if (networkConfig.syncEnabled) {
                            syncData();
                        }
                        
                        showToast(`${inspectionsToImport.length} inspe√ß√µes importadas com sucesso!`, 'success');
                        
                        event.target.value = '';
                    } else {
                        event.target.value = '';
                    }
                    
                } catch (error) {
                    console.error('Erro ao importar JSON:', error);
                    showToast('Erro ao importar arquivo JSON: ' + error.message, 'error');
                    event.target.value = '';
                }
            };
            
            reader.onerror = function() {
                showToast('Erro ao ler o arquivo', 'error');
                event.target.value = '';
            };
            
            reader.readAsText(file);
        }
        
        // Continuar com as outras fun√ß√µes...
        // [O resto das fun√ß√µes do seu c√≥digo original continuam aqui]
        
        function switchChecklistTab(tabId, tabElement) {
            event.preventDefault();
            event.stopPropagation();
            
            document.querySelectorAll('.checklist-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelectorAll('.checklist-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const targetContent = document.getElementById(tabId);
            if (targetContent) {
                targetContent.classList.add('active');
            }
            
            if (tabElement) {
                tabElement.classList.add('active');
            }
            
            updateChecklistSummary();
        }
        
        function updateChecklistSummary() {
            let totalQuestions = 0;
            let answeredQuestions = 0;
            let yesAnswers = 0;
            let noAnswers = 0;

            if (checklistMemory && typeof checklistMemory === 'object') {
                Object.keys(checklistMemory).forEach(tabId => {
                    if (checklistMemory[tabId] && typeof checklistMemory[tabId] === 'object') {
                        Object.keys(checklistMemory[tabId]).forEach(key => {
                            totalQuestions++;
                            const value = checklistMemory[tabId][key];
                            if (value !== 'na') {
                                answeredQuestions++;
                            }
                            if (value === 'sim') {
                                yesAnswers++;
                            } else if (value === 'nao') {
                                noAnswers++;
                            }
                        });
                    }
                });
            }
            
            document.getElementById('totalQuestions').textContent = totalQuestions;
            document.getElementById('answeredQuestions').textContent = answeredQuestions;
            document.getElementById('yesAnswers').textContent = yesAnswers;
            document.getElementById('noAnswers').textContent = noAnswers;
            
            let score = 0;
            if (answeredQuestions > 0) {
                score = Math.round((yesAnswers / answeredQuestions) * 100);
            }
            
            const scoreElement = document.getElementById('summaryScore');
            scoreElement.textContent = `Pontua√ß√£o: ${score}%`;
            
            scoreElement.className = 'summary-score';
            if (score >= 80) {
                scoreElement.classList.add('score-good');
            } else if (score >= 50) {
                scoreElement.classList.add('score-medium');
            } else {
                scoreElement.classList.add('score-bad');
            }
        }
        
        function collectChecklistData() {
            const data = {};
            
            document.querySelectorAll('.checklist-question input[type="radio"]:checked').forEach(input => {
                data[input.name] = input.value;
            });
            
            return data;
        }
        
        function calculateInspectionStatus(photos) {
            if (!photos || photos.length === 0) return 'pending';
            
            const resolvedPhotos = photos.filter(photo => photo.resolved).length;
            
            if (resolvedPhotos === 0) return 'pending';
            if (resolvedPhotos === photos.length) return 'completed';
            return 'in-progress';
        }

        function calculateCompletionPercentage(photos) {
            if (!photos || photos.length === 0) return 0;
            
            const resolvedPhotos = photos.filter(photo => photo.resolved).length;
            return Math.round((resolvedPhotos / photos.length) * 100);
        }

        function setRiskLevel(level) {
            selectedRiskLevel = level;
            document.querySelectorAll('.risk-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.risk-btn.${level}`).classList.add('active');
            saveFormState();
        }

        function getLocation() {
            if (navigator.geolocation) {
                const btn = event.target;
                btn.innerHTML = '<span class="loading"></span> Obtendo...';
                btn.disabled = true;

                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const lat = position.coords.latitude.toFixed(6);
                        const lng = position.coords.longitude.toFixed(6);
                        document.getElementById('location').value = `${lat}, ${lng}`;
                        btn.innerHTML = 'üìç Obter Localiza√ß√£o';
                        btn.disabled = false;
                        showToast('Localiza√ß√£o obtida com sucesso!', 'success');
                        saveFormState();
                    },
                    function(error) {
                        btn.innerHTML = 'üìç Obter Localiza√ß√£o';
                        btn.disabled = false;
                        showToast('Erro ao obter localiza√ß√£o: ' + error.message, 'error');
                    }
                );
            } else {
                showToast('Geolocaliza√ß√£o n√£o suportada pelo navegador', 'error');
            }
        }
        
        let currentPhotoContext = null;
        function showPhotoSourceOptions() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px;">
                    <div class="modal-header">
                        <h3 class="modal-title">Adicionar Foto</h3>
                        <button class="close-modal" onclick="this.parentNode.parentNode.parentNode.remove()">&times;</button>
                    </div>
                    <div class="photo-source-options">
                        <div class="source-option" onclick="openCamera()">
                            <span>üì∑</span>
                            <small>Abrir C√¢mera</small>
                        </div>
                        <div class="source-option" onclick="openGallery()">
                            <span>üñºÔ∏è</span>
                            <small>Abrir Galeria</small>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function openCamera() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.capture = 'environment';
            input.onchange = handlePhotoSelection;
            input.click();
            document.querySelector('.modal.active').remove();
        }

        function openGallery() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = true;
            input.onchange = handlePhotoSelection;
            input.click();
            document.querySelector('.modal.active').remove();
        }

        function compressImage(file, maxWidth = 800, quality = 0.5) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');

                        let { width, height } = img;
                        if (width > maxWidth) {
                            height = (maxWidth / width) * height;
                            width = maxWidth;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;

                        ctx.drawImage(img, 0, 0, width, height);

                        canvas.toBlob((blob) => {
                            if (blob) {
                                const reader = new FileReader();
                                reader.onloadend = () => {
                                    resolve(reader.result);
                                };
                                reader.readAsDataURL(blob);
                            } else {
                                reject(new Error('Falha ao comprimir a imagem.'));
                            }
                        }, 'image/jpeg', quality);
                    };
                    img.onerror = () => reject(new Error('Falha ao carregar a imagem.'));
                    img.src = event.target.result;
                };
                reader.onerror = () => reject(new Error('Falha ao ler o arquivo.'));
                reader.readAsDataURL(file);
            });
        }

        async function handlePhotoSelection(e) {
            const files = e.target.files;
            if (files && files.length > 0) {
                let photosAdded = 0;
                
                for (const file of files) {
                    try {
                        const compressedImageSrc = await compressImage(file);
                        
                        const photo = {
                            id: Date.now() + Math.random(),
                            src: compressedImageSrc,
                            riskLevel: null,
                            description: '',
                            deadlineDate: null,
                            resolved: false,
                            resolutionText: '',
                            resolutionPhotos: [],
                            annotations: []
                        };
                        photos.push(photo);
                        photosAdded++;
                        
                    } catch (error) {
                        console.error('Erro ao processar a foto:', error);
                        showToast(`N√£o foi poss√≠vel adicionar a foto "${file.name}".`, 'error');
                    }
                }
                
                if (photosAdded > 0) {
                    renderPhotoGallery();
                    showToast(`${photosAdded} fotos adicionadas e otimizadas com sucesso!`, 'success');
                    saveFormState();
                }
            }
        }
        
        function closePhotoSourceModal() {
            document.getElementById('photoSourceModal').classList.remove('active');
        }
        
        async function addAreaPhoto() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.capture = 'environment';
            input.multiple = true;
            
            input.onchange = async function(e) {
                const files = e.target.files;
                if (files && files.length > 0) {
                    let galleryHTML = '';
                    
                    for (const file of files) {
                        try {
                            const compressedImageSrc = await compressImage(file);
                            galleryHTML += `
                                <div class="photo-item">
                                    <img src="${compressedImageSrc}" alt="Foto da √Årea">
                                    <div class="photo-actions">
                                        <button class="photo-action-btn" onclick="deleteAreaPhoto(event, this)">
                                            üóëÔ∏è
                                        </button>
                                    </div>
                                </div>
                            `;
                        } catch (error) {
                            console.error('Erro ao processar a foto da √°rea:', error);
                            showToast(`N√£o foi poss√≠vel adicionar a foto da √°rea "${file.name}".`, 'error');
                        }
                    }
                    
                    document.getElementById('areaPhotoGallery').innerHTML = galleryHTML + `
                        <div class="add-photo-btn" onclick="addAreaPhoto()">
                            <span>üì∑</span>
                            <small>Adicionar mais fotos</small>
                        </div>
                    `;
                    saveFormState();
                }
            };
            input.click();
        }
        
        function deleteAreaPhoto(event, element) {
            event.stopPropagation();
            const photoItem = element.closest('.photo-item');
            photoItem.remove();
            saveFormState();
        }
        
        function renderPhotoGallery() {
            const gallery = document.getElementById('photoGallery');
            
            gallery.innerHTML = photos.map((photo, index) => `
                <div class="photo-item">
                    <img src="${photo.src}" alt="Foto ${index + 1}" onclick="viewPhoto(${index})">
                    ${photo.riskLevel ? `
                        <span class="photo-risk-badge ${photo.riskLevel}">
                            ${getRiskLabel(photo.riskLevel)}
                        </span>
                    ` : ''}
                    ${photo.resolved ? `
                        <span class="photo-risk-badge" style="background: var(--success); left: 5px; right: auto;">
                            ‚úÖ Resolvido
                        </span>
                    ` : ''}
                    <div class="photo-actions">
                        <button class="photo-action-btn" onclick="editPhoto(event, ${index})">
                            ‚úèÔ∏è Editar
                        </button>
                        <button class="photo-action-btn" onclick="setPhotoRiskLevel(event, ${index})">
                            ‚ö†Ô∏è Risco
                        </button>
                        <button class="photo-action-btn" onclick="resolvePhoto(event, ${index})">
                            üîß Resolver
                        </button>
                        <button class="photo-action-btn" onclick="deletePhoto(event, ${index})">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('') + `
                <div class="add-photo-btn" onclick="showPhotoSourceOptions()">
                    <span>üì∑</span>
                    <small>Adicionar Foto</small>
                </div>
            `;
        }
        
        function deletePhoto(event, index) {
            event.stopPropagation();
            if (confirm('Deseja excluir esta foto?')) {
                photos.splice(index, 1);
                renderPhotoGallery();
                showToast('Foto exclu√≠da', 'success');
            }
        }
        
        function toggleDeadlineField() {
            const deadlineField = document.getElementById('photoDeadline');
            deadlineField.style.display = document.getElementById('hasPhotoDeadline').checked ? 'block' : 'none';
            if (!document.getElementById('hasPhotoDeadline').checked) {
                deadlineField.value = '';
            }
        }

        function setPhotoRiskLevel(event, index) {
            event.stopPropagation();
            currentPhotoIndex = index;
            currentPhotoRisk = photos[index].riskLevel;
            document.getElementById('photoDescription').value = photos[index].description || '';
            
            if (photos[index].deadlineDate) {
                document.getElementById('hasPhotoDeadline').checked = true;
                document.getElementById('photoDeadline').style.display = 'block';
                document.getElementById('photoDeadline').valueAsDate = new Date(photos[index].deadlineDate);
            }
            
            document.querySelectorAll('#photoRiskModal .risk-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (photos[index].riskLevel) {
                document.querySelector(`#photoRiskModal .risk-btn.${photos[index].riskLevel}`).classList.add('active');
            }
            
            openPhotoRiskModal();
        }
        
        function openPhotoRiskModal() {
            document.getElementById('photoRiskModal').classList.add('active');
        }

        function closePhotoRiskModal() {
            document.getElementById('photoRiskModal').classList.remove('active');
        }

        function setPhotoRisk(level) {
            currentPhotoRisk = level;
            document.querySelectorAll('#photoRiskModal .risk-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`#photoRiskModal .risk-btn.${level}`).classList.add('active');
        }
        
        function savePhotoRisk() {
            if (!currentPhotoRisk) {
                showToast('Selecione um n√≠vel de risco', 'error');
                return;
            }
            
            photos[currentPhotoIndex].riskLevel = currentPhotoRisk;
            photos[currentPhotoIndex].description = document.getElementById('photoDescription').value;
            photos[currentPhotoIndex].deadlineDate = document.getElementById('hasPhotoDeadline').checked ? 
                document.getElementById('photoDeadline').value : null;
                
            renderPhotoGallery();
            closePhotoRiskModal();
            
            if (!currentEditingInspectionId) {
                saveFormState();
            }
            
            showToast('Risco da foto definido!', 'success');
        }

        function resolvePhoto(event, index) {
            event.stopPropagation();
            currentPhotoIndex = index;
            currentPhotoId = photos[index].id;
            
            if (currentEditingInspectionId) {
                currentInspectionId = currentEditingInspectionId;
            }
            
            openPhotoResolutionModal();
        }
        
        function openPhotoResolutionModal() {
            const modal = document.getElementById('photoResolutionModal');
            const modalBody = document.getElementById('resolutionModalBody');
            
            const photo = photos[currentPhotoIndex];
            
            modalBody.innerHTML = `
                <div class="form-group">
                    <label>Foto</label>
                    <img src="${photo.src}" style="max-width: 100%; border-radius: 8px;">
                </div>
                ${photo.riskLevel ? `
                    <div class="form-group">
                        <label>N√≠vel de Risco</label>
                        <span class="risk-badge ${photo.riskLevel}">
                            ${getRiskLabel(photo.riskLevel)}
                        </span>
                    </div>
                ` : ''}
                ${photo.deadlineDate ? `
                    <div class="form-group">
                        <label>Data Limite para Resolu√ß√£o</label>
                        <p>${formatDate(photo.deadlineDate)}</p>
                    </div>
                ` : ''}
                ${photo.description ? `
                    <div class="form-group">
                        <label>Descri√ß√£o</label>
                        <p>${photo.description}</p>
                    </div>
                ` : ''}
                
                <div class="resolution-section">
                    <div class="resolution-header">
                        <h4>Resolu√ß√£o</h4>
                        <span class="resolution-status ${photo.resolved ? 'resolved' : 'pending'}">
                            ${photo.resolved ? 'Resolvido' : 'Pendente'}
                        </span>
                    </div>
                    
                    <div class="resolution-form ${photo.resolved ? '' : 'active'}">
                        <div class="form-group">
                            <label for="resolutionText">Descri√ß√£o da Resolu√ß√£o</label>
                            <textarea id="resolutionText" placeholder="Descreva como esta quest√£o foi resolvida...">${photo.resolutionText || ''}</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Fotos da Resolu√ß√£o</label>
                            <div class="resolution-photos" id="resolutionPhotos">
                                ${photo.resolutionPhotos ? photo.resolutionPhotos.map((resPhoto, index) => `
                                    <div class="resolution-photo">
                                        <img src="${resPhoto}" alt="Foto de resolu√ß√£o ${index + 1}">
                                        <button class="delete-btn" style="position: absolute; top: 5px; right: 5px; opacity: 1;" onclick="deleteResolutionPhoto(${index})">√ó</button>
                                    </div>
                                `).join('') : ''}
                                <div class="add-photo-btn" onclick="addResolutionPhoto()" style="aspect-ratio: 1; height: 120px;">
                                    <span>üì∑</span>
                                    <small>Adicionar Foto</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            ${photo.resolved ? 
                                `<button class="btn btn-secondary" onclick="markAsUnresolved()">
                                    üîô Marcar como N√£o Resolvido
                                </button>` : 
                                `<button class="btn btn-primary" onclick="markAsResolved()">
                                    ‚úÖ Marcar como Resolvido
                                </button>`
                            }
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
        }
        
        function closePhotoResolutionModal() {
            document.getElementById('photoResolutionModal').classList.remove('active');
        }

        function addResolutionPhoto() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        if (!photos[currentPhotoIndex].resolutionPhotos) {
                            photos[currentPhotoIndex].resolutionPhotos = [];
                        }
                        photos[currentPhotoIndex].resolutionPhotos.push(event.target.result);
                        openPhotoResolutionModal();
                        saveFormState();
                        showToast('Foto de resolu√ß√£o adicionada', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function deleteResolutionPhoto(index) {
            if (confirm('Deseja excluir esta foto de resolu√ß√£o?')) {
                photos[currentPhotoIndex].resolutionPhotos.splice(index, 1);
                openPhotoResolutionModal();
                saveFormState();
                showToast('Foto de resolu√ß√£o exclu√≠da', 'success');
            }
        }

        function markAsResolved() {
            const resolutionText = document.getElementById('resolutionText').value;
            
            if (!resolutionText) {
                showToast('Adicione uma descri√ß√£o para a resolu√ß√£o', 'error');
                return;
            }
            
            if (!photos[currentPhotoIndex].resolutionPhotos || photos[currentPhotoIndex].resolutionPhotos.length === 0) {
                showToast('Adicione pelo menos uma foto da resolu√ß√£o', 'error');
                return;
            }
            
            photos[currentPhotoIndex].resolved = true;
            photos[currentPhotoIndex].resolutionText = resolutionText;
            photos[currentPhotoIndex].resolutionDate = new Date().toISOString();
            
            renderPhotoGallery();
            closePhotoResolutionModal();
            
            if (!currentEditingInspectionId) {
                saveFormState();
            }
            
            showToast('Foto marcada como resolvida!', 'success');
        }

        function markAsUnresolved() {
            if (confirm('Tem certeza que deseja marcar esta foto como n√£o resolvida?')) {
                photos[currentPhotoIndex].resolved = false;
                photos[currentPhotoIndex].resolutionText = '';
                photos[currentPhotoIndex].resolutionPhotos = [];
                photos[currentPhotoIndex].resolutionDate = null;
                
                renderPhotoGallery();
                closePhotoResolutionModal();
                
                if (!currentEditingInspectionId) {
                    saveFormState();
                }
                
                showToast('Foto marcada como n√£o resolvida', 'success');
            }
        }
        
        function viewPhoto(index) {
            const photo = photos[index];
            const modal = document.getElementById('inspectionModal');
            const modalBody = document.getElementById('modalBody');
            
            modalBody.innerHTML = `
                <div class="form-group">
                    <label>Foto ${index + 1}</label>
                    <img src="${photo.src}" style="max-width: 100%; border-radius: 8px;">
                </div>
                ${photo.riskLevel ? `
                    <div class="form-group">
                        <label>N√≠vel de Risco</label>
                        <span class="risk-badge ${photo.riskLevel}">
                            ${getRiskLabel(photo.riskLevel)}
                        </span>
                    </div>
                ` : ''}
                ${photo.deadlineDate ? `
                    <div class="form-group">
                        <label>Data Limite para Resolu√ß√£o</label>
                        <p>${formatDate(photo.deadlineDate)}</p>
                    </div>
                ` : ''}
                ${photo.description ? `
                    <div class="form-group">
                        <label>Descri√ß√£o</label>
                        <p>${photo.description}</p>
                    </div>
                ` : ''}
                ${photo.resolved ? `
                    <div class="resolution-section">
                        <div class="resolution-header">
                            <h4>Resolu√ß√£o</h4>
                            <span class="resolution-status resolved">Resolvido em ${formatDate(photo.resolutionDate)}</span>
                        </div>
                        ${photo.resolutionText ? `
                            <div class="form-group">
                                <label>Descri√ß√£o da Resolu√ß√£o</label>
                                <p>${photo.resolutionText}</p>
                            </div>
                        ` : ''}
                        ${photo.resolutionPhotos && photo.resolutionPhotos.length > 0 ? `
                            <div class="form-group">
                                <label>Fotos da Resolu√ß√£o</label>
                                <div class="resolution-photos">
                                    ${photo.resolutionPhotos.map((resPhoto, index) => `
                                        <div class="resolution-photo">
                                            <img src="${resPhoto}" alt="Foto de resolu√ß√£o ${index + 1}">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                ` : ''}
            `;
            
            modal.classList.add('active');
        }
        
        function resetForm() {
            document.getElementById('inspectionForm').reset();
            const today = new Date();
            document.getElementById('inspectionDate').valueAsDate = today;
            const deadline = new Date(today);
            deadline.setDate(deadline.getDate() + 30);
            document.getElementById('deadlineDate').valueAsDate = deadline;
            selectedRiskLevel = null;
            photos = [];
            checklistMemory = {};
            currentEditingInspectionId = null;
            
            document.querySelectorAll('.risk-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.querySelectorAll('.checklist-question input[type="radio"]').forEach(input => {
                input.checked = false;
            });
            
            document.getElementById('areaPhotoGallery').innerHTML = `
                <div class="add-photo-btn" onclick="addAreaPhoto()">
                    <span>üì∑</span>
                    <small>Adicionar Foto da √Årea</small>
                </div>
            `;
            
            renderPhotoGallery();
            updateChecklistSummary();
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.textContent = 'üíæ Salvar Inspe√ß√£o';
            submitBtn.onclick = null;
            
            document.getElementById('formTitle').textContent = 'üìù Nova Inspe√ß√£o';
            
            localStorage.removeItem('formState');
        }
        
        function filterInspections(filter) {
            currentFilter = filter;
            
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderInspections();
        }

        function renderInspections() {
            const container = document.getElementById('historyContainer');
            
            let filteredInspections = inspections;
            if (currentFilter !== 'all') {
                filteredInspections = inspections.filter(inspection => inspection.status === currentFilter);
            }
            
            if (filteredInspections.length === 0) {
                container.innerHTML = `
                    <div class="empty-history">
                        <div class="empty-history-icon">üì≠</div>
                        <p>Nenhuma inspe√ß√£o ${currentFilter !== 'all' ? `com status "${getStatusLabel(currentFilter)}"` : 'registrada ainda'}</p>
                        <p style="font-size: 14px; margin-top: 10px;">${currentFilter !== 'all' ? 'Tente outro filtro ou adicione novas inspe√ß√µes' : 'Comece adicionando sua primeira inspe√ß√£o'}</p>
                    </div>
                `;
                return;
            }

            filteredInspections.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            container.innerHTML = `
                <div class="history-timeline">
                    ${filteredInspections.map(inspection => {
                        const isOverdue = new Date(inspection.deadlineDate) < new Date();
                        const daysLeft = Math.ceil((new Date(inspection.deadlineDate) - new Date()) / (1000 * 60 * 60 * 24));
                        
                        let checklistScore = 0;
                        if (inspection.checklistData) {
                            const totalQuestions = Object.keys(inspection.checklistData).length;
                            const yesAnswers = Object.values(inspection.checklistData).filter(value => value === 'sim').length;
                            if (totalQuestions > 0) {
                                checklistScore = Math.round((yesAnswers / totalQuestions) * 100);
                            }
                        }
                        
                        return `
                            <div class="history-item">
                                <div class="history-date">${formatDate(inspection.timestamp)}</div>
                                <div class="history-content">
                                    <div class="history-title">
                                        <strong>${inspection.areaName}</strong>
                                        <div>
                                            <span class="risk-badge ${inspection.riskLevel}">
                                                ${getRiskLabel(inspection.riskLevel)}
                                            </span>
                                            <span class="history-status ${inspection.status}">
                                                ${getStatusLabel(inspection.status)}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="history-details">
                                        <div class="history-detail">
                                            <span class="history-detail-label">Data:</span>
                                            <span class="history-detail-value">${formatDate(inspection.date)}</span>
                                        </div>
                                        <div class="history-detail">
                                            <span class="history-detail-label">Local:</span>
                                            <span class="history-detail-value">${inspection.location || 'N√£o informado'}</span>
                                        </div>
                                        <div class="history-detail">
                                            <span class="history-detail-label">Fotos:</span>
                                            <span class="history-detail-value">${inspection.photos ? inspection.photos.length : 0}</span>
                                        </div>
                                        <div class="history-detail">
                                            <span class="history-detail-label">Checklist:</span>
                                            <span class="history-detail-value">${checklistScore}% de conformidade</span>
                                        </div>
                                        ${inspection.modifiedBy ? `
                                            <div class="history-detail">
                                                <span class="history-detail-label">Modificado por:</span>
                                                <span class="history-detail-value">${inspection.modifiedBy}</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                    <div class="history-progress">
                                        <div class="history-progress-fill" style="width: ${inspection.completionPercentage || 0}%"></div>
                                    </div>
                                    <div class="progress-text">
                                        <span>${inspection.completionPercentage || 0}% conclu√≠do</span>
                                        <span>${inspection.photos ? inspection.photos.filter(p => p.resolved).length : 0} de ${inspection.photos ? inspection.photos.length : 0} resolvidas</span>
                                    </div>
                                    ${isOverdue ? `
                                        <div class="deadline-warning overdue">
                                            ‚ö†Ô∏è Prazo vencido em ${formatDate(inspection.deadlineDate)}
                                        </div>
                                    ` : daysLeft <= 7 ? `
                                        <div class="deadline-warning">
                                            ‚è∞ Prazo termina em ${daysLeft} dias
                                        </div>
                                    ` : ''}
                                    ${inspection.observations ? `
                                        <div class="history-detail">
                                            <span class="history-detail-label">Observa√ß√µes:</span>
                                            <span class="history-detail-value">${inspection.observations.substring(0, 50)}${inspection.observations.length > 50 ? '...' : ''}</span>
                                        </div>
                                    ` : ''}
                                    <div class="history-actions">
                                        <button class="history-action-btn" onclick="showInspectionDetails(${inspection.id})">
                                            üëÅÔ∏è Ver Detalhes
                                        </button>
                                        <button class="history-action-btn" onclick="editInspection(${inspection.id})">
                                            ‚úèÔ∏è Editar
                                        </button>
                                        <button class="history-action-btn" onclick="deleteInspection(${inspection.id})">
                                            üóëÔ∏è Excluir
                                        </button>
                                    </div>
                                    ${inspection.photos && inspection.photos.length > 0 ? `
                                        <div class="history-photos">
                                            ${inspection.photos.slice(0, 3).map((photo, index) => `
                                                <div class="history-photo">
                                                    <img src="${photo.src}" alt="Foto ${index + 1}">
                                                    ${photo.riskLevel ? `
                                                        <span class="photo-risk-badge ${photo.riskLevel}">
                                                            ${getRiskLabel(photo.riskLevel)}
                                                        </span>
                                                    ` : ''}
                                                    ${photo.resolved ? `
                                                        <span class="photo-risk-badge" style="background: var(--success); left: 5px; right: auto;">
                                                            ‚úÖ
                                                        </span>
                                                    ` : ''}
                                                </div>
                                            `).join('')}
                                            ${inspection.photos.length > 3 ? `
                                                <div class="history-photo">
                                                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--gray-medium);">
                                                        +${inspection.photos.length - 3}
                                                    </div>
                                                </div>
                                            ` : ''}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }
        
        function showInspectionDetails(id) {
            const inspection = inspections.find(i => i.id === id);
            if (!inspection) return;

            currentInspectionId = id;
            
            const modalBody = document.getElementById('modalBody');
            
            let checklistHTML = '';
            if (inspection.checklistData) {
                const totalQuestions = Object.keys(inspection.checklistData).length;
                const yesAnswers = Object.values(inspection.checklistData).filter(value => value === 'sim').length;
                const noAnswers = Object.values(inspection.checklistData).filter(value => value === 'nao').length;
                const naAnswers = Object.values(inspection.checklistData).filter(value => value === 'na').length;
                const score = totalQuestions > 0 ? Math.round((yesAnswers / totalQuestions) * 100) : 0;
                
                const categoryNames = {
                    'epi': 'EPIs', 'inc': 'Inc√™ndio', 'iso': 'Isolamento', 'qui': 'Qu√≠micos',
                    'maq': 'M√°quinas', 'fer': 'Ferramentas', 'arm': 'Armazenamento',
                    'uni': 'Uniformes', 'pis': 'Pisos', 'org': 'Organiza√ß√£o',
                    'esc': 'Escadas', 'ilu': 'Ilumina√ß√£o', 'beb': 'Bebedouros',
                    'ban': 'Banheiros', 'inf': 'Inflam√°veis', 'ele': 'Eletricidade',
                    'escr': 'Escrit√≥rio', 'ficha': 'Ficha EPI'
                };
                
                const questionTexts = {
                    'epi1': 'Possui estoque de EPIs em quantidade suficiente para atender os empregados?',
                    'epi2': 'Os EPIs est√£o adequadamente higienizados?',
                    'epi3': 'Os funcion√°rios receberam orienta√ß√µes para cuidar corretamente dos EPIs?',
                    'inc1': 'A manuten√ß√£o dos equipamentos est√° em dia?',
                    'inc2': 'Os lacres, selos do INMETRO e adesivos orientativos est√£o em perfeito estado de conserva√ß√£o?',
                    'inc3': 'Os extintores est√£o desobstru√≠dos?',
                    'inc4': 'Os equipamentos de combate a inc√™ndio est√£o bem sinalizados?',
                    'inc5': 'Os extintores est√£o dentro do prazo de validade?',
                    'inc6': 'A empresa que faz a recarga dos extintores tem registro no Corpo e Bombeiros?',
                    'iso1': 'Possui equipamentos para isolamento e sinaliza√ß√£o de √°rea?',
                    'iso2': 'Os equipamentos atendem em quantidades e tipos √†s necessidades?',
                    'iso3': 'Os equipamentos est√£o em bom estado de conserva√ß√£o?',
                    'iso4': 'Possui placa de manuten√ß√£o de equipamento?',
                    'qui1': 'O local possui espa√ßo adequado para estoque de produtos qu√≠micos?',
                    'qui2': 'Possuem as fichas de produtos qu√≠micos (FISPQ)?',
                    'qui3': 'Os funcion√°rios foram alertados sobre os riscos no manuseio dos produtos?',
                    'maq1': 'As m√°quinas e equipamentos est√£o em bom estado de conserva√ß√£o?',
                    'maq2': 'As correias, polias e transmissores de for√ßa possuem prote√ß√£o adequada?',
                    'maq3': 'Os dispositivos de seguran√ßa das m√°quinas e equipamentos funcionam corretamente?',
                    'fer1': 'A limpeza das ferramentas manuais √© realizada periodicamente?',
                    'fer2': '√â evitado o uso inadequado ou improvisado das ferramentas e equipamentos?',
                    'fer3': 'As caixas de ferramentas est√£o em boas condi√ß√µes?',
                    'fer4': 'Ao t√©rmino do servi√ßo todas as ferramentas s√£o guardadas em local apropriado?',
                    'arm1': 'Os materiais est√£o empilhados ou ordenados adequadamente?',
                    'uni1': 'Os empregados possuem uniformes limpos e em bom estado de conserva√ß√£o?',
                    'uni2': 'O local possui estoque suficiente para atender as necessidades dos empregados?',
                    'pis1': 'Os pisos apresentam uma superf√≠cie segura para o trabalhador, sem buracos e se poss√≠vel com antiderrapante?',
                    'pis2': 'O piso est√° livre de obst√°culos?',
                    'pis3': 'O piso est√° claramente demarcado em seus locais de risco?',
                    'org1': 'Os locais de trabalho est√£o organizados, livres de sujeiras e de materiais?',
                    'org2': 'As sucatas est√£o em locais inadequados?',
                    'org3': 'O local possui vasilhames para coleta seletiva de lixo?',
                    'esc1': 'Escadas met√°licas t√™m sapatas de borracha para evitar escorreg√µes?',
                    'esc2': 'Os degraus est√£o em bom estado de condi√ß√µes de uso?',
                    'ilu1': 'As lumin√°rias encontram-se em boas condi√ß√µes de conserva√ß√£o e limpas?',
                    'ilu2': 'As lumin√°rias est√£o completas e sem l√¢mpadas queimadas?',
                    'ilu3': 'A ilumina√ß√£o ambiente atende a necessidade, ou √© insuficiente?',
                    'beb1': 'Os bebedouros est√£o em boas condi√ß√µes de funcionamento, com √°gua pot√°vel e filtro n√£o saturado?',
                    'beb2': 'Existem bebedouros em n√∫mero suficiente para atender os colaboradores? (01 para cada 50 trabalhadores)',
                    'beb3': 'Existem copos descart√°veis ou dispositivos adequados para os empregados beberem √°gua?',
                    'ban1': 'Os lavat√≥rios, mict√≥rios e sanit√°rios est√£o em boas condi√ß√µes de uso?',
                    'ban2': 'Existem banheiros e sanit√°rios suficientes para atender cada colaborador? (01 para cada 20 trabalhadores)',
                    'ban3': 'Os chuveiros e arm√°rios est√£o em boas condi√ß√µes de uso?',
                    'ban4': 'Os banheiros e vesti√°rios s√£o higienizados corretamente?',
                    'inf1': 'Os dep√≥sitos de inflam√°veis e combust√≠veis est√£o devidamente identificados e sinalizados?',
                    'inf2': 'Os cilindros s√£o armazenados de forma adequada (em p√©, com capacete de prote√ß√£o, separados por conte√∫do e amarrados por correntes ou cordas)?',
                    'inf3': 'Os conjuntos de oxi-corte possuem v√°lvulas contra retrocesso de chama?',
                    'inf4': 'Os cilindros s√£o armazenados longe de fontes de calor?',
                    'ele1': 'As tomadas, caixas e pain√©is el√©tricos possuem indica√ß√£o de voltagem?',
                    'ele2': 'As exig√™ncias m√≠nimas da NR 10 est√£o sendo cumpridas (equipamentos / instala√ß√µes)?',
                    'ele3': 'A edifica√ß√£o possui aterramento el√©trico?',
                    'escr1': 'As passagens entre m√°quinas e m√≥veis est√£o livres e desimpedidas?',
                    'escr2': 'Os fios de m√°quinas e de telefones est√£o em boas condi√ß√µes e fora das passagens?',
                    'escr3': 'As cadeiras e mesas est√£o com p√©s em bom estado?',
                    'escr4': 'Os ventiladores possuem grade de prote√ß√£o?',
                    'escr5': 'As salas s√£o bem ventiladas e disp√µem de climatiza√ß√£o agrad√°vel?',
                    'escr6': 'As telas dos computadores est√£o na altura correta?',
                    'escr7': 'As cadeiras possuem descanso para bra√ßos?',
                    'ficha1': 'Possui ficha de controle de EPIs?',
                    'ficha2': 'A ficha de controle de EPIs est√° em dia?'
                };
                
                let checklistTableHTML = '<table style="width: 100%; border-collapse: collapse; margin-top: 10px;">';
                checklistTableHTML += '<tr style="background-color: #f2f2f2;"><th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Categoria</th><th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Pergunta</th><th style="border: 1px solid #ddd; padding: 8px; text-align: center;">Resposta</th></tr>';
                
                Object.keys(inspection.checklistData).forEach(key => {
                    const category = key.replace(/\d+$/, '');
                    const categoryName = categoryNames[category] || category;
                    const questionText = questionTexts[key] || key;
                    const answerText = inspection.checklistData[key] === 'sim' ? '‚úÖ Sim' : 
                                     inspection.checklistData[key] === 'nao' ? '‚ùå N√£o' : 
                                     '‚ö™ N/A';
                    const answerColor = inspection.checklistData[key] === 'sim' ? '#28a745' : 
                                      inspection.checklistData[key] === 'nao' ? '#dc3545' : 
                                      '#6c757d';
                    
                    checklistTableHTML += `
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${categoryName}</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">${questionText}</td>
                                                    <td style="border: 1px solid #ddd; padding: 8px; text-align: center; color: ${answerColor}; font-weight: bold;">${answerText}</td>
                        </tr>
                    `;
                });
                
                checklistTableHTML += '</table>';
                
                checklistHTML = `
                    <div class="form-group">
                        <label>Resumo do Checklist de Seguran√ßa</label>
                        <div class="summary-stats">
                            <div class="summary-stat">
                                <span class="summary-stat-value">${totalQuestions}</span>
                                <span class="summary-stat-label">Total</span>
                            </div>
                            <div class="summary-stat">
                                <span class="summary-stat-value">${yesAnswers}</span>
                                <span class="summary-stat-label">Sim</span>
                            </div>
                            <div class="summary-stat">
                                <span class="summary-stat-value">${noAnswers}</span>
                                <span class="summary-stat-label">N√£o</span>
                            </div>
                            <div class="summary-stat">
                                <span class="summary-stat-value">${naAnswers}</span>
                                <span class="summary-stat-label">N/A</span>
                            </div>
                        </div>
                        <div class="summary-score ${score >= 80 ? 'score-good' : score >= 50 ? 'score-medium' : 'score-bad'}">
                            Pontua√ß√£o: ${score}%
                        </div>
                        <div style="margin-top: 20px; overflow-x: auto;">
                            <h4 style="margin-bottom: 10px;">Detalhes do Checklist</h4>
                            ${checklistTableHTML}
                        </div>
                    </div>
                `;
            }
            
            modalBody.innerHTML = `
                <div class="form-group">
                    <label>Nome da √Årea</label>
                    <p style="font-weight: 600;">${inspection.areaName}</p>
                </div>
                <div class="form-group">
                    <label>Data da Inspe√ß√£o</label>
                    <p>${formatDate(inspection.date)}</p>
                </div>
                <div class="form-group">
                    <label>Prazo para Conclus√£o</label>
                    <p>${formatDate(inspection.deadlineDate)}</p>
                </div>
                ${inspection.location ? `
                    <div class="form-group">
                        <label>Localiza√ß√£o</label>
                        <p>üìç ${inspection.location}</p>
                    </div>
                ` : ''}
                <div class="form-group">
                    <label>N√≠vel de Risco Geral</label>
                    <span class="risk-badge ${inspection.riskLevel}">
                        ${getRiskLabel(inspection.riskLevel)}
                    </span>
                    <span class="status-badge ${inspection.status}">
                        ${getStatusLabel(inspection.status)}
                    </span>
                </div>
                <div class="form-group">
                    <label>Progresso</label>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${inspection.completionPercentage || 0}%"></div>
                    </div>
                    <div class="progress-text">
                        <span>${inspection.completionPercentage || 0}% conclu√≠do</span>
                        <span>${inspection.photos ? inspection.photos.filter(p => p.resolved).length : 0} de ${inspection.photos ? inspection.photos.length : 0} fotos resolvidas</span>
                    </div>
                </div>
                ${inspection.modifiedBy ? `
                    <div class="form-group">
                        <label>Modificado por</label>
                        <p>${inspection.modifiedBy}</p>
                    </div>
                ` : ''}
                ${checklistHTML}
                ${inspection.observations ? `
                    <div class="form-group">
                        <label>Observa√ß√µes</label>
                        <p>${inspection.observations}</p>
                    </div>
                ` : ''}
                ${inspection.areaPhoto ? `
                    <div class="form-group">
                        <label>Foto da √Årea</label>
                        <div class="photo-gallery">
                            <div class="photo-item">
                                <img src="${inspection.areaPhoto}" alt="Foto da √Årea" style="max-width: 100%; border-radius: 8px;">
                            </div>
                        </div>
                    </div>
                ` : ''}
                ${inspection.photos && inspection.photos.length > 0 ? `
                    <div class="form-group">
                        <label>Fotos da Inspe√ß√£o (${inspection.photos.length})</label>
                        <div class="photo-gallery">
                            ${inspection.photos.map((photo, index) => `
                                <div class="photo-item" onclick="viewInspectionPhoto('${inspection.id}', ${index})">
                                    <img src="${photo.src}" alt="Foto ${index + 1}">
                                    ${photo.riskLevel ? `
                                        <span class="photo-risk-badge ${photo.riskLevel}">
                                            ${getRiskLabel(photo.riskLevel)}
                                        </span>
                                    ` : ''}
                                    ${photo.resolved ? `
                                        <span class="photo-risk-badge" style="background: var(--success); left: 5px; right: auto;">
                                            ‚úÖ
                                        </span>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="editInspection('${inspection.id}')">
                        ‚úèÔ∏è Editar Inspe√ß√£o
                    </button>
                </div>
            `;
            
            document.getElementById('inspectionModal').classList.add('active');
        }

        function viewInspectionPhoto(inspectionId, photoIndex) {
            const inspection = inspections.find(i => i.id == inspectionId);
            const photo = inspection.photos[photoIndex];
            
            currentPhotoIndex = photos.findIndex(p => p.id === photo.id);
            
            const modal = document.getElementById('inspectionModal');
            const modalBody = document.getElementById('modalBody');
            
            modalBody.innerHTML = `
                <div class="form-group">
                    <label>Foto ${photoIndex + 1} - ${inspection.areaName}</label>
                    <img src="${photo.src}" style="max-width: 100%; border-radius: 8px;">
                </div>
                ${photo.riskLevel ? `
                    <div class="form-group">
                        <label>N√≠vel de Risco</label>
                        <span class="risk-badge ${photo.riskLevel}">
                            ${getRiskLabel(photo.riskLevel)}
                        </span>
                    </div>
                ` : ''}
                ${photo.deadlineDate ? `
                    <div class="form-group">
                        <label>Data Limite para Resolu√ß√£o</label>
                        <p>${formatDate(photo.deadlineDate)}</p>
                    </div>
                ` : ''}
                ${photo.description ? `
                    <div class="form-group">
                        <label>Descri√ß√£o</label>
                        <p>${photo.description}</p>
                    </div>
                ` : ''}
                ${photo.resolved ? `
                    <div class="resolution-section">
                        <div class="resolution-header">
                            <h4>Resolu√ß√£o</h4>
                            <span class="resolution-status resolved">Resolvido em ${formatDate(photo.resolutionDate)}</span>
                        </div>
                        ${photo.resolutionText ? `
                            <div class="form-group">
                                <label>Descri√ß√£o da Resolu√ß√£o</label>
                                <p>${photo.resolutionText}</p>
                            </div>
                        ` : ''}
                        ${photo.resolutionPhotos && photo.resolutionPhotos.length > 0 ? `
                            <div class="form-group">
                                <label>Fotos da Resolu√ß√£o</label>
                                <div class="resolution-photos">
                                    ${photo.resolutionPhotos.map((resPhoto, index) => `
                                        <div class="resolution-photo">
                                            <img src="${resPhoto}" alt="Foto de resolu√ß√£o ${index + 1}">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                ` : ''}
            `;
        }

        function closeModal() {
            document.getElementById('inspectionModal').classList.remove('active');
        }
        
        function editInspection(id) {
            const inspection = inspections.find(i => i.id === id);
            if (!inspection) return;
            
            currentEditingInspectionId = id;
            
            document.getElementById('areaName').value = inspection.areaName;
            document.getElementById('inspectionDate').value = inspection.date;
            document.getElementById('deadlineDate').value = inspection.deadlineDate;
            document.getElementById('location').value = inspection.location || '';
            document.getElementById('observations').value = inspection.observations || '';
            
            setRiskLevel(inspection.riskLevel);
            
            if (inspection.areaPhoto) {
                document.getElementById('areaPhotoGallery').innerHTML = `
                    <div class="photo-item">
                        <img src="${inspection.areaPhoto}" alt="Foto da √Årea">
                        <div class="photo-actions">
                            <button class="photo-action-btn" onclick="deleteAreaPhoto(event, this)">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    <div class="add-photo-btn" onclick="addAreaPhoto()">
                        <span>üì∑</span>
                        <small>Adicionar mais fotos</small>
                    </div>
                `;
            }
            
            photos = JSON.parse(JSON.stringify(inspection.photos || []));
            renderPhotoGallery();
            
            checklistMemory = JSON.parse(JSON.stringify(inspection.checklistData || {}));
            
            populateChecklistForm(checklistMemory);
            
            updateChecklistSummary();
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.textContent = 'üíæ Atualizar Inspe√ß√£o';
            
            document.getElementById('formTitle').textContent = '‚úèÔ∏è Editar Inspe√ß√£o';
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            closeModal();
        }

        function updateInspection(id) {
            console.log("FUN√á√ÉO UPDATEINSPECTION CHAMADA! ID:", id);

            const inspectionIndex = inspections.findIndex(i => i.id === id);
            if (inspectionIndex === -1) return;
            
            if (!selectedRiskLevel) {
                showToast('Por favor, selecione um n√≠vel de risco geral', 'error');
                return;
            }

            if (photos.length === 0) {
                showToast('Por favor, adicione pelo menos uma foto', 'error');
                return;
            }
            
            const areaPhotoGallery = document.getElementById('areaPhotoGallery');
            const areaPhoto = areaPhotoGallery.querySelector('img') ? 
                areaPhotoGallery.querySelector('img').src : null;
                
            const finalChecklistData = collectChecklistData();
            
            inspections[inspectionIndex] = {
                ...inspections[inspectionIndex],
                areaName: document.getElementById('areaName').value,
                areaPhoto: areaPhoto,
                date: document.getElementById('inspectionDate').value,
                deadlineDate: document.getElementById('deadlineDate').value,
                location: document.getElementById('location').value,
                riskLevel: selectedRiskLevel,
                observations: document.getElementById('observations').value,
                photos: photos,
                checklistData: finalChecklistData,
                status: calculateInspectionStatus(photos),
                completionPercentage: calculateCompletionPercentage(photos),
                timestamp: new Date().toISOString(),
                modifiedBy: getCurrentUser(),
                syncStatus: 'pending'
            };
            
            if (saveInspections()) {
                showToast('Inspe√ß√£o atualizada com sucesso!', 'success');
                resetForm();
                renderInspections();
                updateStats();
            }
        }
        
        function deleteInspection(id) {
            if (confirm('Tem certeza que deseja excluir esta inspe√ß√£o? Esta a√ß√£o n√£o pode ser desfeita.')) {
                inspections = inspections.filter(i => i.id !== id);
                saveInspections();
                renderInspections();
                updateStats();
                showToast('Inspe√ß√£o exclu√≠da com sucesso!', 'success');
            }
        }
        
        function getRiskLabel(level) {
            const labels = {
                low: 'Baixo',
                medium: 'M√©dio',
                high: 'Alto'
            };
            return labels[level] || level;
        }

        function getStatusLabel(status) {
            const labels = {
                'pending': 'Pendente',
                'in-progress': 'Em Andamento',
                'completed': 'Conclu√≠do'
            };
            return labels[status] || status;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }

        function updateStats() {
            document.getElementById('totalCount').textContent = inspections.length;
            document.getElementById('highRiskCount').textContent = inspections.filter(i => i.riskLevel === 'high').length;
            
            const overdueCount = inspections.filter(i => new Date(i.deadlineDate) < new Date()).length;
            document.getElementById('overdueCount').textContent = overdueCount;
            
            const completedCount = inspections.filter(i => i.status === 'completed').length;
            document.getElementById('completedCount').textContent = completedCount;
        }
        
        function showToast(message, type = 'success', duration = 3000) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'error' ? 'var(--danger)' : 
                                  type === 'info' ? 'var(--info)' : 'var(--success)';
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        function toggleMenu() {
            const menu = document.getElementById('navMenu');
            menu.classList.toggle('active');
        }

        document.addEventListener('click', function(event) {
            const menu = document.getElementById('navMenu');
            const toggle = document.querySelector('.menu-toggle');
            
            if (!menu.contains(event.target) && event.target !== toggle) {
                menu.classList.remove('active');
            }
        });

        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // Exportar selecionados para PPT
        function exportSelectedPPT() {
            if (inspections.length === 0) {
                showToast('Nenhuma inspe√ß√£o para exportar', 'error');
                return;
            }

            try {
                const pptx = new PptxGenJS();
                
                // Definir master slide
                pptx.defineSlideMaster({
                    title: 'ZAMINE_MASTER',
                    background: { color: 'FFFFFF' },
                    objects: [
                        { 
                            text: { 
                                text: 'ZAMINE', 
                                options: { 
                                    x: 10.5, y: 0.2, w: 1.5, h: 0.5, 
                                    align: 'right', color: '000000', fontSize: 24, bold: true 
                                } 
                            } 
                        }
                    ],
                    slideNumber: { x: 0.5, y: 7.0, w: 10, align: 'center', color: '000000' }
                });

                // Slide de capa
                let coverSlide = pptx.addSlide();
                
                if (inspections.length > 0 && inspections[0].areaPhoto) {
                    coverSlide.addImage({
                        data: inspections[0].areaPhoto,
                        x: 0, y: 0, w: '100%', h: '100%',
                        sizing: { type: 'cover' }
                    });
                    coverSlide.addShape(pptx.ShapeType.rect, {
                        x: 0, y: 0, w: '100%', h: '100%',
                        fill: { color: '595959', transparency: 30 }
                    });
                } else {
                    coverSlide.addShape(pptx.ShapeType.rect, {
                        x: 0, y: 0, w: '100%', h: '100%',
                        fill: { color: '1F3A5F' }
                    });
                    showToast('Aviso: A primeira inspe√ß√£o n√£o possui "Foto da √Årea". Usando um fundo padr√£o.', 'info');
                }
                
                coverSlide.addText('RELAT√ìRIO DE INSPE√á√ÉO', {
                    x: 0.5, y: 1.7, w: 6, h: 1,
                    fontSize: 31.4, bold: true, align: 'left', color: 'FFFFFF',
                    fontFace: 'Arial'
                });
                
                coverSlide.addText('DE SEGURAN√áA', {
                    x: 0.5, y: 2.3, w: 6, h: 0.8,
                    fontSize: 31.4, bold: true, align: 'left', color: 'FF6600',
                    fontFace: 'Arial'
                });
                
                const dataInspecao = formatDate(inspections[0].date);
                const nomeArea = inspections[0].areaName;
                const localizacao = inspections[0].location || 'N√£o informado';

                coverSlide.addText(` Data: ${dataInspecao}`, {
                    x: 0.5, y: 3.0, w: 8, h: 0.5,
                    fontSize: 11, color: 'FFFFFF', align: 'left'
                });

                coverSlide.addText(`Local: ${nomeArea} - ${localizacao} üìç`, {
                    x: 0.5, y: 3.3, w: 8, h: 0.5,
                    fontSize: 11, color: 'FFFFFF', align: 'left'
                });

                // Slide de informa√ß√µes gerais
                let summarySlide = pptx.addSlide({ masterName: 'ZAMINE_MASTER' });
                summarySlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '100%', fill: { color: 'FFFFFF' } });
                summarySlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: 0.6, fill: { color: 'FF6600' } });
                summarySlide.addText('Informa√ß√µes Gerais', { x: 0, y: 0.1, w: '100%', h: 0.4, fontSize: 20, bold: true, align: 'center', color: 'FFFFFF', fontFace: 'Arial' });
                
                const firstInspection = inspections[0];
                let checklistSummaryText = 'N√£o dispon√≠vel';
                if (firstInspection.checklistData) {
                    const totalQuestions = Object.keys(firstInspection.checklistData).length;
                    const answeredQuestions = Object.values(firstInspection.checklistData).filter(value => value !== 'na').length;
                    const yesAnswers = Object.values(firstInspection.checklistData).filter(value => value === 'sim').length;
                    const noAnswers = Object.values(firstInspection.checklistData).filter(value => value === 'nao').length;
                    checklistSummaryText = `${totalQuestions} Total de Perguntas ${answeredQuestions} Respondidas ${yesAnswers} Sim ${noAnswers} N√£o`;
                }

                const infoData = [
                    { label: 'Nome da √Årea', icon: 'üè¢', value: firstInspection.areaName },
                    { label: 'Data da Inspe√ß√£o', icon: 'üìÖ', value: formatDate(firstInspection.date) },
                    { label: 'N√≠vel de Risco Geral', icon: '‚ö†Ô∏è', value: getRiskLabel(firstInspection.riskLevel), isRisk: true, riskLevel: firstInspection.riskLevel },
                    { label: 'Total de Fotos', icon: 'üì∑', value: firstInspection.photos ? firstInspection.photos.length : 0 },
                    { label: 'Inspetor', icon: 'üë§', value: firstInspection.modifiedBy || 'N√£o informado' },
                    { label: 'Resumo do Checklist de Seguran√ßa', icon: '‚öôÔ∏è', value: checklistSummaryText },
                ];

                let currentY = 1.2;
                infoData.forEach(item => {
                    summarySlide.addShape(pptx.ShapeType.rect, { x: 0.7, y: currentY, w: 6, h: 0.5, fill: { color: 'FFFFFF' }, shadow: { type: 'outer', color: '000000', blur: 5, offset: 1 } });
                    summarySlide.addShape(pptx.ShapeType.rect, { x: 0.7, y: currentY, w: 2.5, h: 0.5, fill: { color: 'FF6600', transparency: 90 } });
                    summarySlide.addShape(pptx.ShapeType.rect, { x: 0.7, y: currentY, w: 0.1, h: 0.5, fill: { color: 'FF6600' } });
                    summarySlide.addText([{ text: `${item.icon} `, options: { fontSize: 10, color: 'FF6600' } }, { text: item.label, options: { fontSize: 10, bold: true, color: '000000' } }], { x: 0.9, y: currentY, w: 2.3, h: 0.5, valign: 'middle' });
                    if (item.isRisk) {
                        const riskColor = item.riskLevel === 'high' ? 'DC3545' : item.riskLevel === 'medium' ? 'FFC107' : '28A745';
                        summarySlide.addShape(pptx.ShapeType.rect, { x: 3.3, y: currentY + 0.1, w: 2.5, h: 0.3, fill: { color: '000000', transparency: 95 }, rectRadius: 0.2 });
                        summarySlide.addText(item.value, { x: 3.3, y: currentY + 0.1, w: 2.5, h: 0.3, fontSize: 10, bold: true, color: riskColor, italic: true, align: 'center', valign: 'middle' });
                    } else {
                        summarySlide.addText(item.value, { x: 3.3, y: currentY, w: 3.4, h: 0.5, fontSize: 10, italic: true, color: '999999', valign: 'middle' });
                    }
                    currentY += 0.6;
                });

                // Slides de fotos
                if (firstInspection.photos && firstInspection.photos.length > 0) {
                    const photoWidth = 4.5;
                    const photoHeight = 4.0;
                    const gap = 0.3;
                    const startX = 0.3;

                    for (let i = 0; i < firstInspection.photos.length; i += 2) {
                        let photoSlide = pptx.addSlide({ masterName: 'ZAMINE_MASTER' });
                        
                        photoSlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '100%', fill: { color: 'FFFFFF' } });
                        photoSlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: 0.6, fill: { color: 'FF6600' } });
                        photoSlide.addText('Fotos da Inspe√ß√£o', { x: 0, y: 0.1, w: '100%', h: 0.4, fontSize: 10, bold: true, align: 'center', color: 'FFFFFF', fontFace: 'Arial' });

                        let currentY = 0.8;

                        for (let j = 0; j < 2 && (i + j) < firstInspection.photos.length; j++) {
                            const photo = firstInspection.photos[i + j];
                            const photoNumber = i + j + 1;
                            const riskText = getRiskLabel(photo.riskLevel);
                            const boxX = startX + (j * (photoWidth + gap));

                            photoSlide.addShape(pptx.ShapeType.rect, { x: boxX, y: currentY, w: photoWidth, h: photoHeight, fill: { color: 'FFFFFF' }, shadow: { type: 'outer', color: '000000', blur: 4, offset: 1 } });
                            
                            photoSlide.addShape(pptx.ShapeType.rect, { x: boxX, y: currentY, w: photoWidth, h: 0.4, fill: { color: 'FF6600', transparency: 90 } });
                            photoSlide.addText(`FOTO ${String(photoNumber).padStart(2, '0')}`, { x: boxX + 0.2, y: currentY, w: 2, h: 0.4, fontSize: 12, bold: true, color: 'FF6600', valign: 'middle' });
                            photoSlide.addText(riskText, { x: boxX + 3.3, y: currentY, w: 1.5, h: 0.4, fontSize: 12, italic: true, color: '999999', valign: 'middle', align: 'center' });
                            
                            photoSlide.addImage({ data: photo.src, x: boxX + 0.2, y: currentY + 0.5, w: photoWidth - 0.4, h: photoHeight - 1.0, sizing: { type: 'contain' } });
                            
                            photoSlide.addShape(pptx.ShapeType.rect, { x: boxX, y: currentY + 4.2, w: photoWidth, h: 0.4, fill: { color: 'FF6600' } });
                            photoSlide.addText(photo.description || 'Sem descri√ß√£o', { x: boxX + 0.2, y: currentY + 4.2, w: photoWidth - 0.2, h: 0.4, fontSize: 12, italic: true, color: 'FFFFFF', valign: 'middle' });
                        }
                    }
                }

                // Defini√ß√£o dos textos das perguntas
                const questionTexts = {
                    'epi1': 'Possui estoque de EPIs em quantidade suficiente para atender os empregados?',
                    'epi2': 'Os EPIs est√£o adequadamente higienizados?',
                    'epi3': 'Os funcion√°rios receberam orienta√ß√µes para cuidar corretamente dos EPIs?',
                    'inc1': 'A manuten√ß√£o dos equipamentos est√° em dia?',
                    'inc2': 'Os lacres, selos do INMETRO e adesivos orientativos est√£o em perfeito estado de conserva√ß√£o?',
                    'inc3': 'Os extintores est√£o desobstru√≠dos?',
                    'inc4': 'Os equipamentos de combate a inc√™ndio est√£o bem sinalizados?',
                    'inc5': 'Os extintores est√£o dentro do prazo de validade?',
                    'inc6': 'A empresa que faz a recarga dos extintores tem registro no Corpo e Bombeiros?',
                    'iso1': 'Possui equipamentos para isolamento e sinaliza√ß√£o de √°rea?',
                    'iso2': 'Os equipamentos atendem em quantidades e tipos √†s necessidades?',
                    'iso3': 'Os equipamentos est√£o em bom estado de conserva√ß√£o?',
                    'iso4': 'Possui placa de manuten√ß√£o de equipamento?',
                    'qui1': 'O local possui espa√ßo adequado para estoque de produtos qu√≠micos?',
                    'qui2': 'Possuem as fichas de produtos qu√≠micos (FISPQ)?',
                    'qui3': 'Os funcion√°rios foram alertados sobre os riscos no manuseio dos produtos?',
                    'maq1': 'As m√°quinas e equipamentos est√£o em bom estado de conserva√ß√£o?',
                    'maq2': 'As correias, polias e transmissores de for√ßa possuem prote√ß√£o adequada?',
                    'maq3': 'Os dispositivos de seguran√ßa das m√°quinas e equipamentos funcionam corretamente?',
                    'fer1': 'A limpeza das ferramentas manuais √© realizada periodicamente?',
                    'fer2': '√â evitado o uso inadequado ou improvisado das ferramentas e equipamentos?',
                    'fer3': 'As caixas de ferramentas est√£o em boas condi√ß√µes?',
                    'fer4': 'Ao t√©rmino do servi√ßo todas as ferramentas s√£o guardadas em local apropriado?',
                    'arm1': 'Os materiais est√£o empilhados ou ordenados adequadamente?',
                    'uni1': 'Os empregados possuem uniformes limpos e em bom estado de conserva√ß√£o?',
                    'uni2': 'O local possui estoque suficiente para atender as necessidades dos empregados?',
                    'pis1': 'Os pisos apresentam uma superf√≠cie segura para o trabalhador, sem buracos e se poss√≠vel com antiderrapante?',
                    'pis2': 'O piso est√° livre de obst√°culos?',
                    'pis3': 'O piso est√° claramente demarcado em seus locais de risco?',
                    'org1': 'Os locais de trabalho est√£o organizados, livres de sujeiras e de materiais?',
                    'org2': 'As sucatas est√£o em locais inadequados?',
                    'org3': 'O local possui vasilhames para coleta seletiva de lixo?',
                    'esc1': 'Escadas met√°licas t√™m sapatas de borracha para evitar escorreg√µes?',
                    'esc2': 'Os degraus est√£o em bom estado de condi√ß√µes de uso?',
                    'ilu1': 'As lumin√°rias encontram-se em boas condi√ß√µes de conserva√ß√£o e limpas?',
                    'ilu2': 'As lumin√°rias est√£o completas e sem l√¢mpadas queimadas?',
                    'ilu3': 'A ilumina√ß√£o ambiente atende a necessidade, ou √© insuficiente?',
                    'beb1': 'Os bebedouros est√£o em boas condi√ß√µes de funcionamento, com √°gua pot√°vel e filtro n√£o saturado?',
                    'beb2': 'Existem bebedouros em n√∫mero suficiente para atender os colaboradores? (01 para cada 50 trabalhadores)',
                    'beb3': 'Existem copos descart√°veis ou dispositivos adequados para os empregados beberem √°gua?',
                    'ban1': 'Os lavat√≥rios, mict√≥rios e sanit√°rios est√£o em boas condi√ß√µes de uso?',
                    'ban2': 'Existem banheiros e sanit√°rios suficientes para atender cada colaborador? (01 para cada 20 trabalhadores)',
                    'ban3': 'Os chuveiros e arm√°rios est√£o em boas condi√ß√µes de uso?',
                    'ban4': 'Os banheiros e vesti√°rios s√£o higienizados corretamente?',
                    'inf1': 'Os dep√≥sitos de inflam√°veis e combust√≠veis est√£o devidamente identificados e sinalizados?',
                    'inf2': 'Os cilindros s√£o armazenados de forma adequada (em p√©, com capacete de prote√ß√£o, separados por conte√∫do e amarrados por correntes ou cordas)?',
                    'inf3': 'Os conjuntos de oxi-corte possuem v√°lvulas contra retrocesso de chama?',
                    'inf4': 'Os cilindros s√£o armazenados longe de fontes de calor?',
                    'ele1': 'As tomadas, caixas e pain√©is el√©tricos possuem indica√ß√£o de voltagem?',
                    'ele2': 'As exig√™ncias m√≠nimas da NR 10 est√£o sendo cumpridas (equipamentos / instala√ß√µes)?',
                    'ele3': 'A edifica√ß√£o possui aterramento el√©trico?',
                    'escr1': 'As passagens entre m√°quinas e m√≥veis est√£o livres e desimpedidas?',
                    'escr2': 'Os fios de m√°quinas e de telefones est√£o em boas condi√ß√µes e fora das passagens?',
                    'escr3': 'As cadeiras e mesas est√£o com p√©s em bom estado?',
                    'escr4': 'Os ventiladores possuem grade de prote√ß√£o?',
                    'escr5': 'As salas s√£o bem ventiladas e disp√µem de climatiza√ß√£o agrad√°vel?',
                    'escr6': 'As telas dos computadores est√£o na altura correta?',
                    'escr7': 'As cadeiras possuem descanso para bra√ßos?',
                    'ficha1': 'Possui ficha de controle de EPIs?',
                    'ficha2': 'A ficha de controle de EPIs est√° em dia?'
                };

                // Processamento do checklist
                const checklistData = inspections[0].checklistData;
                if (checklistData) {
                    const categoryNames = {
                        'epi': 'EPIs', 'inc': 'Inc√™ndio', 'iso': 'Isolamento', 'qui': 'Qu√≠micos',
                        'maq': 'M√°quinas', 'fer': 'Ferramentas', 'arm': 'Armazenamento',
                        'uni': 'Uniformes', 'pis': 'Pisos', 'org': 'Organiza√ß√£o',
                        'esc': 'Escadas', 'ilu': 'Ilumina√ß√£o', 'beb': 'Bebedouros',
                        'ban': 'Banheiros', 'inf': 'Inflam√°veis', 'ele': 'Eletricidade',
                        'escr': 'Escrit√≥rio', 'ficha': 'Ficha EPI'
                    };
                    
                    // Agrupar perguntas por categoria e calcular estat√≠sticas
                    const categoryStats = {};
                    for (const key in checklistData) {
                        const category = key.replace(/\d+$/, '');
                        if (!categoryStats[category]) {
                            categoryStats[category] = {
                                name: categoryNames[category] || category,
                                sim: 0,
                                nao: 0,
                                na: 0
                            };
                        }
                        categoryStats[category][checklistData[key]]++;
                    }
                    
                    // Criar slides para cada categoria
                    for (const category in categoryStats) {
                        const stats = categoryStats[category];
                        const questions = [];
                        for (const key in checklistData) {
                            if (key.startsWith(category)) {
                                questions.push({ key, value: checklistData[key] });
                            }
                        }
                        
                        // Criar slide para a categoria
                        let checklistSlide = pptx.addSlide({ masterName: 'ZAMINE_MASTER' });
                        checklistSlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '100%', fill: { color: 'FFFFFF' } });
                        checklistSlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: 0.5, fill: { color: 'FF6600' } });
                        checklistSlide.addText(`Checklist de Seguran√ßa - ${stats.name}`, { 
                            x: 0, y: 0.1, w: '100%', h: 0.3, 
                            fontSize: 18, bold: true, align: 'center', color: 'FFFFFF', fontFace: 'Arial' 
                        });
                        
                        // Calcular estat√≠sticas da categoria
                        const totalQuestions = questions.length;
                        const yesAnswers = stats.sim;
                        const noAnswers = stats.nao;
                        const naAnswers = stats.na;
                        const score = totalQuestions > 0 ? Math.round((yesAnswers / totalQuestions) * 100) : 0;
                        
                        // Adicionar resumo da categoria no topo - REDUZIDO
                        checklistSlide.addShape(pptx.ShapeType.rect, { 
                            x: 0.3, y: 0.6, w: 9.4, h: 0.6, 
                            fill: { color: 'F5F5F5' }, 
                            shadow: { type: 'outer', color: '000000', blur: 2, offset: 1 } 
                        });
                        
                        // T√≠tulo do resumo
                        checklistSlide.addText('Resumo da Categoria', { 
                            x: 0.3, y: 0.6, w: 9.4, h: 0.2, 
                            fontSize: 12, bold: true, color: '333333', align: 'center' 
                        });
                        
                        // Estat√≠sticas - EM UMA √öNICA LINHA
                        checklistSlide.addText(`Total: ${totalQuestions} | Sim: ${yesAnswers} | N√£o: ${noAnswers} | N/A: ${naAnswers}`, { 
                            x: 0.3, y: 0.8, w: 9.4, h: 0.2, 
                            fontSize: 10, color: '666666', align: 'center' 
                        });
                        
                        // Pontua√ß√£o
                        const scoreColor = score >= 80 ? '28A745' : score >= 50 ? 'FFC107' : 'DC3545';
                        checklistSlide.addText(`Pontua√ß√£o: ${score}%`, { 
                            x: 0.3, y: 1.0, w: 9.4, h: 0.2, 
                            fontSize: 14, bold: true, color: scoreColor, align: 'center' 
                        });
                        
                        // Adicionar cada pergunta - ESPA√áAMENTO REDUZIDO
                        let currentY = 1.3; // Reduzido de 1.9
                        const questionHeight = 0.35; // Reduzido de 0.6
                        const questionGap = 0.05; // Reduzido de 0.1
                        
                        questions.forEach(q => {
                            const questionText = questionTexts[q.key] || q.key;
                            const answerText = q.value === 'sim' ? '‚úÖ Sim' : 
                                              q.value === 'nao' ? '‚ùå N√£o' : 
                                              '‚ö™ N/A';
                            const answerColor = q.value === 'sim' ? '28A745' : 
                                              q.value === 'nao' ? 'DC3545' : 
                                              '6C757D';
                            
                            // Caixa para a pergunta - TAMANHO REDUZIDO
                            checklistSlide.addShape(pptx.ShapeType.rect, { 
                                x: 0.3, y: currentY, w: 9.4, h: questionHeight, 
                                fill: { color: 'FFFFFF' }, 
                                shadow: { type: 'outer', color: '000000', blur: 1, offset: 0.5 } 
                            });
                            
                            // Categoria - TAMANHO REDUZIDO
                            checklistSlide.addShape(pptx.ShapeType.rect, { 
                                x: 0.3, y: currentY, w: 1.5, h: questionHeight, 
                                fill: { color: 'FF6600', transparency: 90 } 
                            });
                            checklistSlide.addText(stats.name, { 
                                x: 0.3, y: currentY, w: 1.5, h: questionHeight, 
                                fontSize: 10, bold: true, color: 'FF6600', valign: 'middle', align: 'center' 
                            });
                            
                            // Pergunta - FONTE MENOR
                            checklistSlide.addText(questionText, { 
                                x: 1.8, y: currentY + 0.05, w: 5.5, h: questionHeight - 0.1, 
                                fontSize: 9, color: '000000', valign: 'middle' 
                            });
                            
                            // Resposta - POSI√á√ÉO AJUSTADA
                            checklistSlide.addText(answerText, { 
                                x: 7.3, y: currentY, w: 2.4, h: questionHeight, 
                                fontSize: 10, bold: true, color: answerColor, valign: 'middle', align: 'center' 
                            });
                            
                            currentY += questionHeight + questionGap;
                        });
                    }
                    
                    // Adicionar slide de resumo geral do checklist com gr√°fico de barras horizontais
                    let summaryGeneralSlide = pptx.addSlide({ masterName: 'ZAMINE_MASTER' });
                    summaryGeneralSlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '100%', fill: { color: 'FFFFFF' } });
                    summaryGeneralSlide.addShape(pptx.ShapeType.rect, { x: 0, y: 0, w: '100%', h: 0.6, fill: { color: 'FF6600' } });
                    summaryGeneralSlide.addText('Resumo Geral do Checklist', { 
                        x: 0, y: 0.1, w: '100%', h: 0.4, 
                        fontSize: 20, bold: true, align: 'center', color: 'FFFFFF', fontFace: 'Arial' 
                    });
                    
                    // Preparar dados para o gr√°fico de barras horizontais
                    const categories = Object.keys(categoryStats).map(cat => categoryStats[cat].name);
                    const simData = Object.keys(categoryStats).map(cat => categoryStats[cat].sim);
                    const naoData = Object.keys(categoryStats).map(cat => categoryStats[cat].nao);
                    const naData = Object.keys(categoryStats).map(cat => categoryStats[cat].na);
                    
                    // Adicionar gr√°fico de barras horizontais
                    const chartData = [
                        {
                            name: 'Sim',
                            labels: categories,
                            values: simData
                        },
                        {
                            name: 'N√£o',
                            labels: categories,
                            values: naoData
                        },
                        {
                            name: 'N/A',
                            labels: categories,
                            values: naData
                        }
                    ];

                    summaryGeneralSlide.addChart(pptx.ChartType.bar, chartData, {
                        x: 0.5, y: 1.2, w: 4.5, h: 3.5, // Ajustado para caber melhor
                        barDir: 'bar', // Barras horizontais
                        showLegend: true,
                        legendPos: 'r',
                        legendFontFace: 'Arial',
                        legendFontSize: 10,
                        dataLabelFormatCode: '#,##0',
                        showDataLabels: true,
                        dataLabelFontFace: 'Arial',
                        dataLabelFontSize: 9, // Reduzido
                        dataLabelColor: 'FFFFFF',
                        title: 'Respostas por Categoria',
                        titleFontFace: 'Arial',
                        titleFontSize: 12, // Reduzido
                        titleColor: '333333',
                        catAxisLabelColor: '333333',
                        catAxisLabelFontFace: 'Arial',
                        catAxisLabelFontSize: 8,
                        valAxisLabelColor: '333333',
                        valAxisLabelFontFace: 'Arial',
                        valAxisLabelFontSize: 8,
                        valAxisMaxVal: Math.max(...simData, ...naoData, ...naData) + 1,
                        barGapWidthPct: 20, // Reduzido
                        barGrouping: 'stacked',
                        chartColors: ['28A745', 'DC3545', '6C757D'],
                        showCatAxisLines: false,
                        showValAxisLines: false,
                        gridLine: { color: 'FFFFFF', size: 0 }
                    });
                    
                    // Calcular estat√≠sticas gerais
                    const allQuestions = Object.keys(checklistData);
                    const totalQuestions = allQuestions.length;
                    const yesAnswers = allQuestions.filter(key => checklistData[key] === 'sim').length;
                    const noAnswers = allQuestions.filter(key => checklistData[key] === 'nao').length;
                    const naAnswers = allQuestions.filter(key => checklistData[key] === 'na').length;
                    const score = totalQuestions > 0 ? Math.round((yesAnswers / totalQuestions) * 100) : 0;
                    
                    // Adicionar estat√≠sticas em texto - LAYOUT OTIMIZADO
                    summaryGeneralSlide.addText(`Total de Perguntas: ${totalQuestions}`, { 
                        x: 5.5, y: 1.2, w: 3.5, h: 0.4, 
                        fontSize: 12, bold: true, color: '333333' 
                    });
                    
                    summaryGeneralSlide.addText(`Respostas "Sim": ${yesAnswers}`, { 
                        x: 5.5, y: 1.7, w: 3.5, h: 0.4, 
                        fontSize: 11, color: '28A745' 
                    });
                    
                    summaryGeneralSlide.addText(`Respostas "N√£o": ${noAnswers}`, { 
                        x: 5.5, y: 2.2, w: 3.5, h: 0.4, 
                        fontSize: 11, color: 'DC3545' 
                    });
                    
                    summaryGeneralSlide.addText(`Respostas "N/A": ${naAnswers}`, { 
                        x: 5.5, y: 2.7, w: 3.5, h: 0.4, 
                        fontSize: 11, color: '6C757D' 
                    });
                    
                    // Pontua√ß√£o geral - TAMANHO REDUZIDO
                    const scoreColor = score >= 80 ? '28A745' : score >= 50 ? 'FFC107' : 'DC3545';
                    const scoreStatus = score >= 80 ? 'Conformidade Alta' : score >= 50 ? 'Conformidade M√©dia' : 'Requer Aten√ß√£o';
                    
                    summaryGeneralSlide.addShape(pptx.ShapeType.rect, { 
                        x: 5.5, y: 3.4, w: 3.5, h: 1.0, // Reduzido
                        fill: { color: 'F5F5F5' }, 
                        shadow: { type: 'outer', color: '000000', blur: 2, offset: 1 } 
                    });
                    
                    summaryGeneralSlide.addText('Pontua√ß√£o Geral', { 
                        x: 5.5, y: 3.4, w: 3.5, h: 0.25, 
                        fontSize: 12, bold: true, color: '333333', align: 'center' 
                    });
                    
                    summaryGeneralSlide.addText(`${score}%`, { 
                        x: 5.5, y: 3.7, w: 3.5, h: 0.4, 
                        fontSize: 24, bold: true, color: scoreColor, align: 'center' 
                    });
                    
                    summaryGeneralSlide.addText(scoreStatus, { 
                        x: 5.5, y: 4.1, w: 3.5, h: 0.25, 
                        fontSize: 11, color: scoreColor, align: 'center' 
                    });
                }

                // Gerar o arquivo
                pptx.writeFile({ fileName: `relatorio_inspecoes_${new Date().toISOString().split('T')[0]}.pptx` }).then(() => {
                    const totalSlides = pptx.slides.length;
                    showToast(`Relat√≥rio exportado com sucesso (${totalSlides} slides)!`, 'success');
                });

            } catch (error) {
                console.error("Erro ao gerar PPT:", error);
                showToast('Ocorreu um erro ao gerar o arquivo PPT. Verifique o console do navegador (F12) para mais detalhes.', 'error');
            }
        }
        
        function populateChecklistForm(checklistData) {
            document.querySelectorAll('.checklist-question input[type="radio"]').forEach(input => {
                input.checked = false;
            });

            if (!checklistData) {
                console.log("populateChecklistForm: Nenhum dado de checklist para popular.");
                return;
            }

            for (const inputName in checklistData) {
                const answerValue = checklistData[inputName];
                
                const radioToCheck = document.querySelector(`input[name="${inputName}"][value="${answerValue}"]`);
                
                if (radioToCheck) {
                    radioToCheck.checked = true;
                } else {
                    console.warn(`Campo do checklist n√£o encontrado: name="${inputName}", value="${answerValue}"`);
                }
            }
        }
    </script>
</body>
</html>
